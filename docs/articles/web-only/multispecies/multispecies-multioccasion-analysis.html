<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Perils of multispecies and multisession distance sampling analysis • Distance</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../../deps/search-1.0.0/fuse.min.js"></script><script src="../../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../../pkgdown.js"></script><meta property="og:title" content="Perils of multispecies and multisession distance sampling analysis">
<meta name="description" content="Example using Montrave data employing `region_table` and `sample_table` construct
">
<meta property="og:description" content="Example using Montrave data employing `region_table` and `sample_table` construct
">
<script type="text/javascript">(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)}; t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;   y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window, document, "clarity", "script", "m9rbql4acz");</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../../index.html">Distance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../../reference/index.html">Function reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../../articles/lines-distill.html">Line transects</a></li>
    <li><a class="dropdown-item" href="../../../articles/covariates-distill.html">Covariates in detection</a></li>
    <li><a class="dropdown-item" href="../../../articles/species-covariate-distill.html">Species as a covariate</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Only for the website</h6></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/points/pointtransects-distill.html">Point transects</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.html">Size bias remedy</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/strata/strata-distill.html">Stratification</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/differences/differences.html">Detecting difference in density between strata</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/variance/variance-distill.html">Variance estimation with bootstrap</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/cues/cuecounts-distill.html">Cue count surveys</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/multipliers/multipliers-distill.html">Indirect surveys</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/multispecies/multispecies-multioccasion-analysis.html">Take care when subsetting multispecies data sets</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/CTDS/camera-distill.html">Camera trap distance sampling</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/alt-optimise/mcds-dot-exe.html">Alternative optimiser</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/predict_detprob/predicting_detection_probabilities.html">Predict detection probabilities</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/Distance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perils of multispecies and multisession distance sampling analysis</h1>
                        <h4 data-toc-skip class="author">Eric Rexstad</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">April 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/Distance/blob/HEAD/vignettes/web-only/multispecies/multispecies-multioccasion-analysis.Rmd" class="external-link"><code>vignettes/web-only/multispecies/multispecies-multioccasion-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>multispecies-multioccasion-analysis.Rmd</code></div>
    </address>
</div>

    
    
<div class="section level2">
<h2 id="a-multispecies-data-set-with-multiple-visits">A multispecies data set with multiple visits<a class="anchor" aria-label="anchor" href="#a-multispecies-data-set-with-multiple-visits"></a>
</h2>
<p>It is increasingly common for investigators to conduct surveys in which multiple species are detected and density estimates for several species are of interest. There are many ways of analysing such data sets, but care must be taken. Not all approaches will produce correct density estimates. To demonstrate one of the ways to produce incorrect estimates, we will use the line transect survey data reported in <span class="citation">Buckland (2006)</span>. This survey (and data file) recorded detections of four species of songbirds. We conduct an analysis of chaffinch <em>(Fringilla coelebs)</em> (coded <code>c</code> in the data file), but similar results would arise with the other species.</p>
<p>Begin by reading the flat file in a comma delimited format. Note the URL for the data file is very long, double check that you can read the URL including the Github token.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urlfile</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/DistanceDevelopment/Distance/refs/heads/master/vignettes/montrave-line.csv"</span></span>
<span><span class="va">birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file<span class="op">=</span><span class="va">urlfile</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="survey-design">Survey design<a class="anchor" aria-label="anchor" href="#survey-design"></a>
</h2>
<p>Buckland’s design consisted of visiting each of the 19 transects in his study twice. To examine some of the errors that can arise from improper analysis, I choose to treat the two visits as <code>strata</code> for the express purpose of generating stratum (visit) -specific density estimates. Density estimates reported in <span class="citation">Buckland (2006)</span> are in units of birds <span class="math inline">\(\cdot hectare^{-1}\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">birds</span><span class="op">$</span><span class="va">Region.Label</span> <span class="op">&lt;-</span> <span class="va">birds</span><span class="op">$</span><span class="va">visit</span></span>
<span><span class="va">cu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/convert_units.html">convert_units</a></span><span class="op">(</span><span class="st">"meter"</span>, <span class="st">"kilometer"</span>, <span class="st">"hectare"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis-of-only-one-species-incorrectly">Analysis of only one species (incorrectly)<a class="anchor" aria-label="anchor" href="#analysis-of-only-one-species-incorrectly"></a>
</h2>
<p>The direct approach to producing a density estimate for the chaffinch would be to subset the original data frame and use the species-specific data frame for analysis. Begin by performing the subset operation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chaf</span> <span class="op">&lt;-</span> <span class="va">birds</span><span class="op">[</span><span class="va">birds</span><span class="op">$</span><span class="va">species</span><span class="op">==</span><span class="st">"c"</span>, <span class="op">]</span></span></code></pre></div>
<p>When the data are subset, the integrity of the survey design is not preserved. A simple frequency table of the species-specific data frame flags up a number of transect/visit combinations where no chaffinches were detected. The result is that the subset data frame suggests 3 of the 19 transects lacked chaffinch detections on the first visit and one of the 19 transects lacked chaffinch detections on the second visit. This revelation, in itself, causes no problems for our estimate of density of chaffinches.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">detects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">chaf</span><span class="op">$</span><span class="va">Sample.Label</span>, <span class="va">chaf</span><span class="op">$</span><span class="va">visit</span><span class="op">)</span></span>
<span><span class="va">detects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">detects</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">detects</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Transect"</span>, <span class="st">"Visit"</span>, <span class="st">"Detections"</span><span class="op">)</span></span>
<span><span class="va">detects</span><span class="op">$</span><span class="va">Detections</span> <span class="op">&lt;-</span> <span class="fu">cell_spec</span><span class="op">(</span><span class="va">detects</span><span class="op">$</span><span class="va">Detections</span>, </span>
<span>                          background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">detects</span><span class="op">$</span><span class="va">Detections</span><span class="op">==</span><span class="fl">0</span>, <span class="st">"red"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">detects</span>, escape<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_paper</span><span class="op">(</span>full_width<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
Transect
</th>
<th style="text-align:left;">
Visit
</th>
<th style="text-align:left;">
Detections
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">4</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">5</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">4</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">2</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: red !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: red !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">2</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: red !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">4</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">2</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">4</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: red !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">2</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">4</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">1</span>
</td>
</tr>
</tbody>
</table>
<p>However, there is a problem hidden within the table above. Transect 12 does not appear in the table because there were no detections of chaffinches on <em>either</em> visit. Consequently, there were 4 transects without chaffinches on the first visit and 2 transects without chaffinches on the second visit, rather than the 3 transects and 1 transect you might mistakenly conclude do not have chaffinch detections if you relied completely upon the table.</p>
<p>Let’s see what the <code><a href="../../../reference/ds.html">ds()</a></code> function thinks about the survey effort using information from the species-specific data frame.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chaf.wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">chaf</span>, key<span class="op">=</span><span class="st">"hn"</span>, convert_units <span class="op">=</span> <span class="va">cu</span>, truncation<span class="op">=</span><span class="fl">95</span>, formula <span class="op">=</span> <span class="op">~</span><span class="va">Region.Label</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">chaf.wrong</span><span class="op">$</span><span class="va">dht</span><span class="op">$</span><span class="va">individuals</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_paper</span><span class="op">(</span>full_width<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">column_spec</span><span class="op">(</span><span class="fl">6</span>, background<span class="op">=</span><span class="st">"salmon"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">column_spec</span><span class="op">(</span><span class="fl">7</span>, background<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
Region
</th>
<th style="text-align:right;">
Area
</th>
<th style="text-align:right;">
CoveredArea
</th>
<th style="text-align:right;">
Effort
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
ER
</th>
<th style="text-align:right;">
se.ER
</th>
<th style="text-align:right;">
cv.ER
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
33.2
</td>
<td style="text-align:right;">
82.061
</td>
<td style="text-align:right;">
4.319
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;background-color: salmon !important;">
15
</td>
<td style="text-align:right;background-color: steelblue !important;">
9.029868
</td>
<td style="text-align:right;">
1.1159303
</td>
<td style="text-align:right;">
0.1235821
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
33.2
</td>
<td style="text-align:right;">
83.562
</td>
<td style="text-align:right;">
4.398
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;background-color: salmon !important;">
17
</td>
<td style="text-align:right;background-color: steelblue !important;">
7.730787
</td>
<td style="text-align:right;">
0.9798153
</td>
<td style="text-align:right;">
0.1267420
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
66.4
</td>
<td style="text-align:right;">
165.623
</td>
<td style="text-align:right;">
8.717
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;background-color: salmon !important;">
32
</td>
<td style="text-align:right;background-color: steelblue !important;">
8.380327
</td>
<td style="text-align:right;">
0.7425191
</td>
<td style="text-align:right;">
0.0886026
</td>
</tr>
</tbody>
</table>
<p>Examine the column labelled <code>k</code> (the number of transects) for each of the visits. Rather than the 19 transects that were surveyed on each visit, the <code><a href="../../../reference/ds.html">ds()</a></code> function erroneously believes there were only 15 transects surveyed on the first visit and 17 transects surveyed on the second visit.</p>
<p>Note also the number of detections per kilometer; roughly 9 on the first visit and 7.7 on the second visit. These encounter rates exclude kilometers of effort on transects where there were no detections. We will return to this comparison later.</p>
</div>
<div class="section level2">
<h2 id="use-explicit-data-hierarchy">Use explicit data hierarchy<a class="anchor" aria-label="anchor" href="#use-explicit-data-hierarchy"></a>
</h2>
<p>Additional arguments can be passed to <code><a href="../../../reference/ds.html">ds()</a></code> to resolve this problem. Consulting the <code><a href="../../../reference/ds.html">ds()</a></code> documentation</p>
<div class="section level3" collapse="false" appearance="default" icon="true">
<h3 id="help-file-for-ds">Help file for <code>ds</code><a class="anchor" aria-label="anchor" href="#help-file-for-ds"></a>
</h3>
<ul>
<li>region_table data.frame with two columns:
<ul>
<li>Region.Label label for the region</li>
<li>Area area of the region</li>
<li>region_table has one row for each stratum. If there is no stratification then region_table has one entry with Area corresponding to the total survey area. If Area is omitted density estimates only are produced.</li>
</ul>
</li>
<li>sample_table data.frame mapping the regions to the samples (i.e. transects). There are three columns:
<ul>
<li>Sample.Label label for the sample</li>
<li>Region.Label label for the region that the sample belongs to.</li>
<li>Effort the effort expended in that sample (e.g. transect length).</li>
</ul>
</li>
</ul>
</div>
<p>This analysis that produces erroneous results can be remedied by explicitly letting the <code><a href="../../../reference/ds.html">ds()</a></code> function know about the study design; specifically, how many strata and the number of transects within each stratum (and associated transect lengths).</p>
<p>Construct the <code>region table</code> and <code>sample table</code> showing the two strata with equal areas and each labelled transect (of given length) is repeated two times.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">birds.regiontable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Region.Label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, Area<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">33.2</span>,<span class="fl">33.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">birds.sampletable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Region.Label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                Sample.Label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span>, times<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                Effort<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.208</span>, <span class="fl">0.401</span>, <span class="fl">0.401</span>, <span class="fl">0.299</span>, <span class="fl">0.350</span>,</span>
<span>                                         <span class="fl">0.401</span>, <span class="fl">0.393</span>, <span class="fl">0.405</span>, <span class="fl">0.385</span>, <span class="fl">0.204</span>,</span>
<span>                                         <span class="fl">0.039</span>, <span class="fl">0.047</span>, <span class="fl">0.204</span>, <span class="fl">0.271</span>, <span class="fl">0.236</span>,</span>
<span>                                         <span class="fl">0.189</span>, <span class="fl">0.177</span>, <span class="fl">0.200</span>, <span class="fl">0.020</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simple-detection-function-model">Simple detection function model<a class="anchor" aria-label="anchor" href="#simple-detection-function-model"></a>
</h2>
<p>The chaffinch analysis is performed again, this time supplying the <code>region_table</code> and <code>sample_table</code> information to <code><a href="../../../reference/ds.html">ds()</a></code>. The correct number of transects (19) sampled on both visits (even though chaffinch was not detected on 4 transects on visit 1 and 2 transects on visit 2) is now recognised. Hence, the use of <code>region table</code> and <code>sample table</code> <strong>solves the problem</strong> of effort miscalculation if a species is not detected on all transects.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fl">95</span>   <span class="co"># as per Buckland (2006)</span></span>
<span><span class="va">onlycf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">birds</span><span class="op">[</span><span class="va">birds</span><span class="op">$</span><span class="va">species</span><span class="op">==</span><span class="st">"c"</span>, <span class="op">]</span>, </span>
<span>             region_table <span class="op">=</span> <span class="va">birds.regiontable</span>,</span>
<span>             sample_table <span class="op">=</span> <span class="va">birds.sampletable</span>,</span>
<span>             trunc<span class="op">=</span><span class="va">tr</span>, convert_units<span class="op">=</span><span class="va">cu</span>, key<span class="op">=</span><span class="st">"hn"</span>, formula <span class="op">=</span> <span class="op">~</span><span class="va">Region.Label</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">onlycf</span><span class="op">$</span><span class="va">dht</span><span class="op">$</span><span class="va">individuals</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_paper</span><span class="op">(</span>full_width<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">column_spec</span><span class="op">(</span><span class="fl">6</span>, background<span class="op">=</span><span class="st">"salmon"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">column_spec</span><span class="op">(</span><span class="fl">7</span>, background<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
Region
</th>
<th style="text-align:right;">
Area
</th>
<th style="text-align:right;">
CoveredArea
</th>
<th style="text-align:right;">
Effort
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
ER
</th>
<th style="text-align:right;">
se.ER
</th>
<th style="text-align:right;">
cv.ER
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
33.2
</td>
<td style="text-align:right;">
91.77
</td>
<td style="text-align:right;">
4.83
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;background-color: salmon !important;">
19
</td>
<td style="text-align:right;background-color: steelblue !important;">
8.074534
</td>
<td style="text-align:right;">
1.2196305
</td>
<td style="text-align:right;">
0.1510465
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
33.2
</td>
<td style="text-align:right;">
91.77
</td>
<td style="text-align:right;">
4.83
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;background-color: salmon !important;">
19
</td>
<td style="text-align:right;background-color: steelblue !important;">
7.039338
</td>
<td style="text-align:right;">
1.0612781
</td>
<td style="text-align:right;">
0.1507639
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
66.4
</td>
<td style="text-align:right;">
183.54
</td>
<td style="text-align:right;">
9.66
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;background-color: salmon !important;">
38
</td>
<td style="text-align:right;background-color: steelblue !important;">
7.556936
</td>
<td style="text-align:right;">
0.8083641
</td>
<td style="text-align:right;">
0.1069698
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="consequence-of-incorrect-analysis">Consequence of incorrect analysis<a class="anchor" aria-label="anchor" href="#consequence-of-incorrect-analysis"></a>
</h2>
<p>To drive home the consequence of failing to properly specify the survey effort, contrast the encounter rate for the two visits from the incorrect calculations above (9.0 and 7.7 respectively), with the correct calculation (8.1 and 7.0 respectively). The number of transects is incorrect with the knock-on effect of effort being incorrect. If effort is incorrect then so too is covered area.<br>
The ripple effect from incomplete information about the survey design results in positively biased estimates of density.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Buckland2006" class="csl-entry">
Buckland, S. T. (2006). Point transect surveys for songbirds: Robust methodologies. <em>The Auk</em>, <em>123</em>(2), 345–357. <a href="https://doi.org/10.1093/auk/123.2.345" class="external-link">https://doi.org/10.1093/auk/123.2.345</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer>
</div>





  </body>
</html>
