<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Point transect density estimation • Distance</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../../deps/search-1.0.0/fuse.min.js"></script><script src="../../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../../pkgdown.js"></script><meta property="og:title" content="Point transect density estimation">
<meta name="description" content="Example analysis of point transect songbird data.
">
<meta property="og:description" content="Example analysis of point transect songbird data.
">
<script type="text/javascript">(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)}; t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;   y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window, document, "clarity", "script", "m9rbql4acz");</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../../index.html">Distance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../../reference/index.html">Function reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../../articles/lines-distill.html">Line transects</a></li>
    <li><a class="dropdown-item" href="../../../articles/covariates-distill.html">Covariates in detection</a></li>
    <li><a class="dropdown-item" href="../../../articles/species-covariate-distill.html">Species as a covariate</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Only for the website</h6></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/points/pointtransects-distill.html">Point transects</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.html">Size bias remedy</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/strata/strata-distill.html">Stratification</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/differences/differences.html">Detecting difference in density between strata</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/variance/variance-distill.html">Variance estimation with bootstrap</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/cues/cuecounts-distill.html">Cue count surveys</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/multipliers/multipliers-distill.html">Indirect surveys</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/multispecies/multispecies-multioccasion-analysis.html">Take care when subsetting multispecies data sets</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/CTDS/camera-distill.html">Camera trap distance sampling</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/alt-optimise/mcds-dot-exe.html">Alternative optimiser</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/predict_detprob/predicting_detection_probabilities.html">Predict detection probabilities</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/Distance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Point transect density estimation</h1>
                        <h4 data-toc-skip class="author">Eric Rexstad</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">April 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/Distance/blob/HEAD/vignettes/web-only/points/pointtransects-distill.Rmd" class="external-link"><code>vignettes/web-only/points/pointtransects-distill.Rmd</code></a></small>
      <div class="d-none name"><code>pointtransects-distill.Rmd</code></div>
    </address>
</div>

    
    
<p>In this exercise, we use <code>R</code> <span class="citation">(R Core Team, 2019)</span> and the <code>Distance</code> package <span class="citation">(Miller, Rexstad, Thomas, Marshall, &amp; Laake, 2019)</span> to fit different detection function models to point transect survey data of savanna sparrows <em>(Passerculus sandwichensis)</em> density and abundance. These data were part of a study examining the effect of livestock grazing upon vegetation structure and consequently upon the avian community described by Knopf et al. <span class="citation">(1988)</span>.</p>
<p>Steps in this analysis are similar to the steps taken in the <a href="https://distancesampling.org/Distance/articles/lines-distill.html" class="external-link">line transect analysis of winter wren data</a>.</p>
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<ul>
<li>Fit a basic detection function using the <code>ds</code> function</li>
<li>Plot and examine a detection function</li>
<li>Fit different detection function forms.</li>
</ul>
</div>
<div class="section level2">
<h2 id="survey-design">Survey design<a class="anchor" aria-label="anchor" href="#survey-design"></a>
</h2>
<p>A total of 373 point transects were placed in three pastures in the Arapaho National Wildlife Refuge in Colorado (Figure <a href="#fig:fig">1</a>). Elevation of these pastures was ~2500m. We will not deal with pasture-level analysis of these data in this vignette and will alter the data to remove the strata designations.</p>
<div class="figure">
<span style="display:block;" id="fig:fig"></span>
<img src="arapaho.JPG" alt="Summer grazed pastures along Illinois River Arapaho National Wildlife Refuge, Colorado.  Figure from [@knopf_guild_1988]."><p class="caption">
Figure 1: Summer grazed pastures along Illinois River Arapaho National Wildlife Refuge, Colorado. Figure from <span class="citation">(Knopf et al., 1988)</span>.
</p>
</div>
<p>The fields of the <code>Savannah_sparrow_1980</code> data set are:</p>
<ul>
<li>Region.Label - three pastures that constituted sections of the study area. However, for this vignette we are going to make all labels identical. This will treat the data as if they were all detected in the same pasture. The matter of stratification will be taken up in another vignette.</li>
<li>Area - size of the study region. A place holder, because pasture sizes are not known. Estimates of density and abundance will be equivalent.</li>
<li>Sample.Label - point transect identifier (total of 373 points)</li>
<li>Effort - number of visits to each point</li>
<li>object - unique identifier for each detected savanna sparrow</li>
<li>distance - radial distance (metres) to each detection</li>
<li>Study.Area - only data for savanna sparrow (SASP) are included in this data set</li>
</ul>
</div>
<div class="section level2">
<h2 id="make-the-data-available-for-r-session">Make the data available for R session<a class="anchor" aria-label="anchor" href="#make-the-data-available-for-r-session"></a>
</h2>
<p>This command assumes that the <code>dsdata</code> package has been installed on your computer. The R workspace <code>Savannah_sparrow_1980</code> contains detections of savanna sparrows from point transect surveys of Knopf et al. <span class="citation">(1988)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/Distance/" class="external-link">Distance</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Savannah_sparrow_1980</span><span class="op">)</span></span>
<span><span class="co">#  remove pasture-level identifier in Region.Label</span></span>
<span><span class="va">Savannah_sparrow_1980</span><span class="op">$</span><span class="va">Region.Label</span> <span class="op">&lt;-</span> <span class="st">"Single_stratum"</span></span></code></pre></div>
<p>The code above overwrites the strata designations in the original data to make it appear that all data were derived from a single stratum. This makes the analysis simpler to perform. There are examples of analysis of <a href="https://distancesampling.org/Distance/articles/web-only/strata/strata-distill.html" class="external-link">stratified data in another vignette</a>.</p>
<p>Examine the first few rows of <code>Savannah_sparrow_1980</code> using the function <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Savannah_sparrow_1980</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Region.Label Area Sample.Label Effort object distance Study.Area</span></span>
<span><span class="co">## 1 Single_stratum    1    POINT   1      1     NA       NA  SASP 1980</span></span>
<span><span class="co">## 2 Single_stratum    1    POINT   2      1     NA       NA  SASP 1980</span></span>
<span><span class="co">## 3 Single_stratum    1    POINT   3      1     NA       NA  SASP 1980</span></span>
<span><span class="co">## 4 Single_stratum    1    POINT   4      1     NA       NA  SASP 1980</span></span>
<span><span class="co">## 5 Single_stratum    1    POINT   5      1     NA       NA  SASP 1980</span></span>
<span><span class="co">## 6 Single_stratum    1    POINT   6      1     NA       NA  SASP 1980</span></span></code></pre>
<p>The object <code>Savannah_sparrow_1980</code> is a dataframe object made up of rows and columns. In contrast to the <a href="https://distancesampling.org/Distance/articles/lines-distill.html" class="external-link">Montrave winter wren line transect data used in the previous vignette</a>, Savannah sparrows were not detected at all point transects. Radial distances receive the value <code>NA</code> for transects where there were no detections. To determine the number of detections in this data set, we total the number of values in the <code>distance</code> field that are not <code>NA</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Savannah_sparrow_1980</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 276</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="examine-the-distribution-of-detection-distances">Examine the distribution of detection distances<a class="anchor" aria-label="anchor" href="#examine-the-distribution-of-detection-distances"></a>
</h2>
<p>Gain familiarity with the radial distance data using the <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code> function (Figure <a href="#fig:basichist">2</a>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Savannah_sparrow_1980</span><span class="op">$</span><span class="va">distance</span>, xlab<span class="op">=</span><span class="st">"Distance (m)"</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Savannah sparrow point transects"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:basichist"></span>
<img src="pointtransects-distill_files/figure-html/basichist-1.png" alt="Histogram of radial distances of savannah sparrows across all pastures."><p class="caption">
Figure 2: Histogram of radial distances of savannah sparrows across all pastures.
</p>
</div>
<p>Note the shape of the radial distance histogram does not resemble the shape of perpendicular distances gathered from line transect sampling <span class="citation">(Buckland, Rexstad, Marques, &amp; Oedekoven, 2015, sec. 1.3)</span>.</p>
</div>
<div class="section level2">
<h2 id="specify-unit-conversions">Specify unit conversions<a class="anchor" aria-label="anchor" href="#specify-unit-conversions"></a>
</h2>
<p>With point transects, there are only units of measure associated with the size of the study area and the radial distance measures, because effort is measured in number of visits, rather than distance.</p>
<ul>
<li>distance_units
<ul>
<li>units of measure for radial distances</li>
</ul>
</li>
<li>effort_units
<ul>
<li>units of measure for effort (<code>NULL</code> for point transects)</li>
</ul>
</li>
<li>area_units
<ul>
<li>units of measure for the study area. Recall this data set has set the size of the study area to be <code>1</code>, resulting in abundance and density to be equal.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conversion.factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/convert_units.html">convert_units</a></span><span class="op">(</span><span class="st">"meter"</span>, <span class="cn">NULL</span>, <span class="st">"hectare"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-a-simple-detection-function-model-with-ds">Fitting a simple detection function model with <code>ds</code><a class="anchor" aria-label="anchor" href="#fitting-a-simple-detection-function-model-with-ds"></a>
</h2>
<p>Detection functions are fitted using the <code>ds</code> function and this function requires a data frame to have a column called <code>distance</code>. We have this in our <code>nests</code> data, therefore, we can simply supply the name of the data frame to the function along with additional arguments.</p>
<p>Details about the arguments for this function:</p>
<ul>
<li>
<code>key="hn"</code>
<ul>
<li>fit a half-normal key detection function</li>
</ul>
</li>
<li>
<code>adjustment=NULL</code>
<ul>
<li>do not include adjustment terms</li>
</ul>
</li>
<li>
<code>transect="point"</code>
<ul>
<li>necessary to indicate this is point transect data</li>
</ul>
</li>
<li>
<code>convert_units=conversion.factor</code>
<ul>
<li>required because, for this example, the radial distances are in metres . Our density estimates will be reported in number of birds per hectare.</li>
</ul>
</li>
<li>
<code>truncation="5%"</code>
<ul>
<li>right truncation (described below)</li>
</ul>
</li>
</ul>
<p>As is customary, right truncation is employed to remove 5% of the observations most distant from the transects, as detections at these distances contain little information about the shape of the fitted probability density function near the point.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sasp.hn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">Savannah_sparrow_1980</span>, key<span class="op">=</span><span class="st">"hn"</span>, adjustment<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>              transect<span class="op">=</span><span class="st">"point"</span>, convert_units<span class="op">=</span><span class="va">conversion.factor</span>, truncation<span class="op">=</span><span class="st">"5%"</span><span class="op">)</span></span></code></pre></div>
<p>On calling the <code>ds</code> function, information is provided to the screen reminding the user what model has been fitted and the associated AIC value. More information is supplied by applying the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function to the object created by <code><a href="../../../reference/ds.html">ds()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sasp.hn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for distance analysis </span></span>
<span><span class="co">## Number of observations :  262 </span></span>
<span><span class="co">## Distance range         :  0  -  51.025 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model       : Half-normal key function </span></span>
<span><span class="co">## AIC         :  2021.776 </span></span>
<span><span class="co">## Optimisation:  mrds (nlminb) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection function parameters</span></span>
<span><span class="co">## Scale coefficient(s):  </span></span>
<span><span class="co">##             estimate         se</span></span>
<span><span class="co">## (Intercept) 3.044624 0.04270318</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                       Estimate          SE         CV</span></span>
<span><span class="co">## Average p             0.321125  0.02296165 0.07150378</span></span>
<span><span class="co">## N in covered region 815.881752 71.61153776 0.08777196</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary statistics:</span></span>
<span><span class="co">##           Region Area CoveredArea Effort   n   k        ER      se.ER</span></span>
<span><span class="co">## 1 Single_stratum    1    305.0877    373 262 373 0.7024129 0.04726421</span></span>
<span><span class="co">##        cv.ER</span></span>
<span><span class="co">## 1 0.06728836</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Label Estimate        se         cv      lcl      ucl       df</span></span>
<span><span class="co">## 1 Total 2.674253 0.2625745 0.09818612 2.206266 3.241509 598.5905</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Label Estimate        se         cv      lcl      ucl       df</span></span>
<span><span class="co">## 1 Total 2.674253 0.2625745 0.09818612 2.206266 3.241509 598.5905</span></span></code></pre>
<p>Visually inspect the fitted detection function with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function, specifying the cutpoints histogram with argument <code>breaks</code>. Add the argument <code>pdf</code> so the plot shows the probability densiy function rather than the detection function. The probability density function is preferred for assessing model fit because the PDF incorporates information about the availability of animals to be detected. There are few animals available to be detected at small distances, therefore lack of fit at small distances is not as consequential for points as it is for lines (Figure <a href="#fig:modelfit">3</a>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Savannah_sparrow_1980</span><span class="op">$</span><span class="va">distance</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sasp.hn</span>, breaks<span class="op">=</span><span class="va">cutpoints</span>, pdf<span class="op">=</span><span class="cn">TRUE</span>, main<span class="op">=</span><span class="st">"Savannah sparrow point transect data."</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:modelfit"></span>
<img src="pointtransects-distill_files/figure-html/modelfit-1.png" alt="Fit of half normal detection function to savannah sparrow data."><p class="caption">
Figure 3: Fit of half normal detection function to savannah sparrow data.
</p>
</div>
</div>
<div class="section level2">
<h2 id="specifying-different-detection-functions">Specifying different detection functions<a class="anchor" aria-label="anchor" href="#specifying-different-detection-functions"></a>
</h2>
<p>Detection function forms and shapes, are specified by changing the <code>key</code> and <code>adjustment</code> arguments.</p>
<p>The options available for <code>key</code> and <code>adjustment</code> elements detection functions are:</p>
<ul>
<li>half normal (<code>key="hn"</code>) - default</li>
<li>hazard rate (<code>key="hr"</code>)</li>
<li>uniform (<code>key="unif"</code>)</li>
<li>no adjustment terms (<code>adjustment=NULL</code>)</li>
<li>cosine (<code>adjustment="cos"</code>) - default</li>
<li>Hermite polynomial (<code>adjustment="herm"</code>)</li>
<li>Simple polynomial (<code>adjustment="poly"</code>)</li>
</ul>
<p>To fit a uniform key function with cosine adjustment terms, use the command:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sasp.unif.cos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">Savannah_sparrow_1980</span>, key<span class="op">=</span><span class="st">"unif"</span>, adjustment<span class="op">=</span><span class="st">"cos"</span>,</span>
<span>                    transect<span class="op">=</span><span class="st">"point"</span>, convert_units<span class="op">=</span><span class="va">conversion.factor</span>, truncation<span class="op">=</span><span class="st">"5%"</span><span class="op">)</span></span></code></pre></div>
<p>To fit a hazard rate key function with simple polynomial adjustment terms, then use the command:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sasp.hr.poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">Savannah_sparrow_1980</span>, key<span class="op">=</span><span class="st">"hr"</span>, adjustment<span class="op">=</span><span class="st">"poly"</span>, </span>
<span>                   transect<span class="op">=</span><span class="st">"point"</span>, convert_units<span class="op">=</span><span class="va">conversion.factor</span>, truncation<span class="op">=</span><span class="st">"5%"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in ddf.ds(dsmodel = dsmodel, data = data, meta.data = meta.data, :</span></span>
<span><span class="co">## Estimated hazard-rate scale parameter close to 0 (on log scale). Possible</span></span>
<span><span class="co">## problem in data (e.g., spike near zero distance).</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>Each fitted detection function produces a different estimate of Savannah sparrow abundance and density. The estimate depends upon the model chosen. The model selection tool for distance sampling data is AIC.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">sasp.hn</span>, <span class="va">sasp.hr.poly</span>, <span class="va">sasp.unif.cos</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               df      AIC</span></span>
<span><span class="co">## sasp.hn        1 2021.776</span></span>
<span><span class="co">## sasp.hr.poly   3 2024.785</span></span>
<span><span class="co">## sasp.unif.cos  1 2023.178</span></span></code></pre>
<div class="section level3">
<h3 id="absolute-goodness-of-fit">Absolute goodness of fit<a class="anchor" aria-label="anchor" href="#absolute-goodness-of-fit"></a>
</h3>
<p>In addition to the relative ranking of models provided by AIC, it is also important to know whether selected model(s) actually fit the data. The model is the basis of inference, so it is dangerous to make inference from a model that does not fit the data. Goodness of fit is assessed using the function <code>gof_ds</code> (Figure <a href="#fig:gof">4</a>).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../../reference/gof_ds.html">gof_ds</a></span><span class="op">(</span><span class="va">sasp.hn</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:gof"></span>
<img src="pointtransects-distill_files/figure-html/gof-1.png" alt="Q-Q plot of half normal detection function to savannah sparrow data."><p class="caption">
Figure 4: Q-Q plot of half normal detection function to savannah sparrow data.
</p>
</div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Goodness of fit results for ddf object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling Cramer-von Mises test (unweighted)</span></span>
<span><span class="co">## Test statistic = 0.0835959 p-value = 0.671325</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="model-comparison-tables">Model comparison tables<a class="anchor" aria-label="anchor" href="#model-comparison-tables"></a>
</h2>
<p>The function <code>summarise_ds_models</code> combines the work of <code>AIC</code> and <code>gof_ds</code> to produce a table of fitted models and summary statistics.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../../../reference/summarize_ds_models.html">summarize_ds_models</a></span><span class="op">(</span><span class="va">sasp.hn</span>, <span class="va">sasp.hr.poly</span>, <span class="va">sasp.unif.cos</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">3</span>,</span>
<span>             caption<span class="op">=</span><span class="st">"Model selection summary of savannah sparrow point transect data."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-11">Table 1: </span>Model selection summary of savannah sparrow point transect data.</caption>
<colgroup>
<col width="2%">
<col width="15%">
<col width="41%">
<col width="5%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Model</th>
<th align="left">Key function</th>
<th align="left">Formula</th>
<th align="right">C-vM p-value</th>
<th align="right"><span class="math inline">\(\hat{P_a}\)</span></th>
<th align="right">se(<span class="math inline">\(\hat{P_a}\)</span>)</th>
<th align="right">
<span class="math inline">\(\Delta\)</span>AIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left"></td>
<td align="left">Half-normal</td>
<td align="left">~1</td>
<td align="right">0.671</td>
<td align="right">0.321</td>
<td align="right">0.023</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left"></td>
<td align="left">Uniform with cosine adjustment term of order 1</td>
<td align="left">NA</td>
<td align="right">0.364</td>
<td align="right">0.350</td>
<td align="right">0.015</td>
<td align="right">1.402</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left"></td>
<td align="left">Hazard-rate with simple polynomial adjustment term of order 4</td>
<td align="left">~1</td>
<td align="right">0.904</td>
<td align="right">0.295</td>
<td align="right">0.053</td>
<td align="right">3.009</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>Key differences between analysis of line transect data and point transect data</p>
<ul>
<li>argument <code>transect</code> in <code><a href="../../../reference/ds.html">ds()</a></code> must be set to <code>"point"</code>,</li>
<li>histogram of radial detection distances is characteristically “humped” because few individuals are available to be detected near the points,</li>
<li>because of the hump shape (Figure <a href="#fig:basichist">2</a>), plotting to assess fit of data to detection distribution usually assessed via <code>pdf=TRUE</code> argument added to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function,</li>
<li>for the Arapaho National Refuge Savannah sparrow data, the three candidate models all provide adequeate fit to the data and produce comparable estimates of <span class="math inline">\(P_a\)</span>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-buckland2015distance" class="csl-entry">
Buckland, S., Rexstad, E., Marques, T., &amp; Oedekoven, C. (2015). <em>Distance sampling: Methods and applications</em>. Springer.
</div>
<div id="ref-knopf_guild_1988" class="csl-entry">
Knopf, F. L., Sedgwick, J. A., &amp; Cannon, R. W. (1988). Guild structure of a riparian avifauna relative to seasonal cattle grazing. <em>The Journal of Wildlife Management</em>, <em>52</em>(2), 280–290. <a href="https://doi.org/10.2307/3801235" class="external-link">https://doi.org/10.2307/3801235</a>
</div>
<div id="ref-miller_distance_2019" class="csl-entry">
Miller, D. L., Rexstad, E., Thomas, L., Marshall, L., &amp; Laake, J. L. (2019). Distance sampling in r. <em>Journal of Statistical Software</em>, <em>89</em>(1), 1–28. <a href="https://doi.org/10.18637/jss.v089.i01" class="external-link">https://doi.org/10.18637/jss.v089.i01</a>
</div>
<div id="ref-r_core_team_r_2019" class="csl-entry">
R Core Team. (2019). <em>R: A language and environment for statistical computing</em>. <span>Vienna Austria</span>: R Foundation for Statistical Computing.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer>
</div>





  </body>
</html>
