<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Solving the size bias problem â€¢ Distance</title>
<script src="../../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../../deps/search-1.0.0/fuse.min.js"></script><script src="../../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../../pkgdown.js"></script><meta property="og:title" content="Solving the size bias problem">
<meta name="description" content="Eastern tropical Pacific spotted dolphin surveys from tuna fishing vessels.
">
<meta property="og:description" content="Eastern tropical Pacific spotted dolphin surveys from tuna fishing vessels.
">
</head>
<body>
<p>








  list(file = "Clarity.txt")

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../../index.html">Distance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../../reference/index.html">Function reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../../articles/lines-distill.html">Line transects</a></li>
    <li><a class="dropdown-item" href="../../../articles/covariates-distill.html">Covariates in detection</a></li>
    <li><a class="dropdown-item" href="../../../articles/species-covariate-distill.html">Species as a covariate</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Only for the website</h6></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/points/pointtransects-distill.html">Point transects</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.html">Size bias remedy</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/strata/strata-distill.html">Stratification</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/differences/differences.html">Detecting difference in density between strata</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/variance/variance-distill.html">Variance estimation with bootstrap</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/cues/cuecounts-distill.html">Cue count surveys</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/multipliers/multipliers-distill.html">Indirect surveys</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/multispecies/multispecies-multioccasion-analysis.html">Take care when subsetting multispecies data sets</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/CTDS/camera-distill.html">Camera trap distance sampling</a></li>
    <li><a class="dropdown-item" href="../../../articles/web-only/alt-optimise/mcds-dot-exe.html">Alternative optimiser</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/Distance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Solving the size bias problem</h1>
                        <h4 data-toc-skip class="author">Eric Rexstad</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">November 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/Distance/blob/HEAD/vignettes/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.Rmd" class="external-link"><code>vignettes/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.Rmd</code></a></small>
      <div class="d-none name"><code>Remedy-size-bias-for-dolphin-surveys.Rmd</code></div>
    </address>
</div>

    
    
<p>In this example we have a sample of sightings data from eastern tropical Pacific (ETP) offshore spotted dolphin, collected by observers board tuna vessels (the data were made available by the Inter-American Tropical Tuna Commission - IATTC). More details about surveys of dolphins in the ETP can be found in <span class="citation">T. Gerrodette &amp; Forcada (2005)</span> and <span class="citation">Tim Gerrodette (2008)</span>. In the ETP, schools of yellow fin tuna commonly associate with schools of certain species of dolphins, and so vessels fishing for tuna often search for dolphins in the hopes of also locating tuna. For each school detected by the tuna vessels, the observer records the species, sighting angle and distance (later converted to perpendicular distance and truncated at 5 nautical miles), school size, and a number of covariates associated with each detected school.</p>
<p>A variety of search methods were used to find the dolphins from these tuna vessels. The coding in the data set is shown below.</p>
<table class="table table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-2">Table 1: </span><span id="tab:unnamed-chunk-2">Table 2: </span>Search method coding from tuna vessels in ETP.
</caption>
<thead><tr>
<th style="text-align:left;">
Method
</th>
<th style="text-align:right;">
code
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Crows nest
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Bridge
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Helicopter
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Radar
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>Some of these methods may have a wider range of search than the others, and so it is possible that the detection function varies according to the method being used.</p>
<p>For each sighting the initial cue type is recorded. This may be birds flying above the school, splashes on the water, floating objects such as logs, or some other unspecified cue.</p>
<table class="table table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-3">Table 3: </span><span id="tab:unnamed-chunk-3">Table 4: </span>Cue coding from tuna vessels in ETP.
</caption>
<thead><tr>
<th style="text-align:left;">
Cue
</th>
<th style="text-align:right;">
code
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Birds
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Splashes
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Unspecified cue
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Floating objects
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
<p>Another covariate that potentially affects the detection function is sea state. Beaufort levels are grouped into two categories, the first including Beaufort values ranging from 0 to 2 (coded as 1) and the second containing values from 3 to 5 (coded as 2).</p>
<p>The sample data encompasses sightings made over a three month summer period.</p>
<table class="table table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-4">Table 5: </span><span id="tab:unnamed-chunk-4">Table 6: </span>Month coding from tuna vessels in ETP.
</caption>
<thead><tr>
<th style="text-align:left;">
Month
</th>
<th style="text-align:right;">
code
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
June
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
July
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
August
</td>
<td style="text-align:right;">
8
</td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="prepare-data-for-analysis">Prepare data for analysis<a class="anchor" aria-label="anchor" href="#prepare-data-for-analysis"></a>
</h2>
</div>
<div class="section level2">
<h2 id="exploratory-data-analysis">Exploratory data analysis<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis"></a>
</h2>
<p>As described, there are a number of potential covariates that might influence dolphin detectability. Rather than throw all covariates into detection function models, examine the distribution of detection distances (y-axis of figure below) as a function of the plausible factor covariates.</p>
<div class="figure">
<span style="display:block;" id="fig:EDA"></span>
<img src="Remedy-size-bias-for-dolphin-surveys_files/figure-html/EDA-1.png" alt="Exploratory data analysis using violin plots.  Prepared using the `vioplot` package.  Number of detections show above plots."><p class="caption">
Figure 1: Exploratory data analysis using violin plots. Prepared using the <code>vioplot</code> package. Number of detections show above plots.
</p>
</div>
<p>From Fig. <a href="#fig:EDA">1</a> there are several decisions to be made concerning the remaining analysis:</p>
<ul>
<li>there is no discernible effect of month or sea state upon distribution of detection distances in this data set. Those covariates will not feature in subsequent modelling.<br>
</li>
<li>the distribution of detection distances by cue type appears to differ for splashes and floating objects. However, the number of detections associated with splash (n=25) or float objects (n=22) cues is small, accounting for ~4% of the total number of detections. I choose to ignore variability in detection probability associated with cue type.</li>
<li>shape of the distribution of detections likely does change for the different search methods. However, the method for which detection distances are most different is the helicopter. The violin plot shows there to be roughly an equal number of pods detected between 4 and 5 nautical miles as were detected between 0 and 1 nautical miles.
<ul>
<li>the proper way to handle this situation would be to remove helicopter sightings from the detection function modelling. Detectability could be assumed perfect out to the truncation distance, hence treat the helicopter portion of the survey as a strip transect. The number of pods detected by helicopters could be added into the estimated number of pods within the covered area. We will remove detections by helicopter from the remainder of our analysis.</li>
</ul>
</li>
<li>the number of detections by radar is small and unlikely to exert much influence upon detection function modelling.</li>
</ul>
<div class="section level3">
<h3 id="evidence-for-size-bias">Evidence for size bias<a class="anchor" aria-label="anchor" href="#evidence-for-size-bias"></a>
</h3>
<p>Size bias <span class="citation">(Buckland et al., 2001)</span> can be examined by plotting distribution of group size as a function of detection distances.</p>
<div class="figure">
<span style="display:block;" id="fig:boxplot"></span>
<img src="Remedy-size-bias-for-dolphin-surveys_files/figure-html/boxplot-1.png" alt="Box plot of observed group sizes by perpendicular distance band. Outliers are not shown; notches indicate discernable difference in mean group size at 2nm."><p class="caption">
Figure 2: Box plot of observed group sizes by perpendicular distance band. Outliers are not shown; notches indicate discernable difference in mean group size at 2nm.
</p>
</div>
<p>Fig. <a href="#fig:boxplot">2</a> indicates a difference in observed mean group size at 2nm; with average group size being distinctly larger at distances greater than 2nm. Hence, average group size in the sample is an overestimate of the average group size in the population. Our modelling of the detection function will need to counteract this bias by including group size in the detection function.</p>
</div>
</div>
<div class="section level2">
<h2 id="stage-one-of-detection-function-modelling">Stage one of detection function modelling<a class="anchor" aria-label="anchor" href="#stage-one-of-detection-function-modelling"></a>
</h2>
<p>Before creating a host of candidate models, we should address with the question of the appropriate key function for these data. Recall we are not including sightings made from the helicopter platform in our analyses.</p>
<p>Fitting models with half normal key function without adjustments and with and without <code>Search.method</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">nochopper</span>, key<span class="op">=</span><span class="st">"hn"</span>, adjustment <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">hn.method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">nochopper</span>, key<span class="op">=</span><span class="st">"hn"</span>, formula <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Search.method</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../../reference/gof_ds.html">gof_ds</a></span><span class="op">(</span><span class="va">hn</span>, main<span class="op">=</span><span class="st">"HN key, no adj"</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Goodness of fit results for ddf object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling Cramer-von Mises test (unweighted)</span></span>
<span><span class="co">## Test statistic = 0.656421 p-value = 0.0162635</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../../reference/gof_ds.html">gof_ds</a></span><span class="op">(</span><span class="va">hn.method</span>, main<span class="op">=</span><span class="st">"HN key + method"</span>, cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="Remedy-size-bias-for-dolphin-surveys_files/figure-html/unnamed-chunk-5-1.png" alt="Q-Q goodness of fit plots for half normal key function without adjustments also including search method as a covariate."><p class="caption">
Figure 3: Q-Q goodness of fit plots for half normal key function without adjustments also including search method as a covariate.
</p>
</div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Goodness of fit results for ddf object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling Cramer-von Mises test (unweighted)</span></span>
<span><span class="co">## Test statistic = 0.672219 p-value = 0.0148816</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>indicates a lack of fit of the half normal key function models. After some rounding to the trackline, the detection function maintains a shoulder before falling away quite rapidly. Even taking into consideration the idea that the sample size is very large (n=961), making the goodness of fit test quite powerful, there is some doubt that the half normal key function is appropriate for these data. We will remove the half normal from further modelling, as the hazard rate will serve our purposes, as the hazard rate without adjustments or covariates, adequately fit the data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">nochopper</span>, key<span class="op">=</span><span class="st">"hr"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Starting AIC adjustment term selection.</span></span></code></pre>
<pre><code><span><span class="co">## Fitting hazard-rate key function</span></span></code></pre>
<pre><code><span><span class="co">## AIC= 2920.797</span></span></code></pre>
<pre><code><span><span class="co">## Fitting hazard-rate key function with cosine(2) adjustments</span></span></code></pre>
<pre><code><span><span class="co">## Warning in check.mono(result, n.pts = control$mono.points): Detection function</span></span>
<span><span class="co">## is greater than 1 at some distances</span></span>
<span><span class="co">## Warning in check.mono(result, n.pts = control$mono.points): Detection function</span></span>
<span><span class="co">## is greater than 1 at some distances</span></span></code></pre>
<pre><code><span><span class="co">## AIC= 2922.8</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Hazard-rate key function selected.</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../../reference/gof_ds.html">gof_ds</a></span><span class="op">(</span><span class="va">hr</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Goodness of fit results for ddf object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling Cramer-von Mises test (unweighted)</span></span>
<span><span class="co">## Test statistic = 0.130299 p-value = 0.455606</span></span></code></pre>
<div class="section level3">
<h3 id="counteracting-size-bias">Counteracting size bias<a class="anchor" aria-label="anchor" href="#counteracting-size-bias"></a>
</h3>
<p>Conducting our modeling using the hazard rate key function, we turn our attention to incorporating group size into the detection function. The way to counteract the effect of size bias is to include group size in the detection function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr.size</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">nochopper</span>, key<span class="op">=</span><span class="st">"hr"</span>, formula <span class="op">=</span> <span class="op">~</span><span class="va">size</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Model contains covariate term(s): no adjustment terms will be included.</span></span></code></pre>
<pre><code><span><span class="co">## Fitting hazard-rate key function</span></span></code></pre>
<pre><code><span><span class="co">## AIC= 2919.357</span></span></code></pre>
<p>It is a disappointment to learn that a model including group size as a covariate fails to converge. There are numerical difficulties associated with a covariate that spans three orders of magnitude. For more about fitting issues with covariates, consult the <a href="../../covariates-distill.Rmd">covariate example with amakihi</a>.</p>
<p>The distribution of group sizes is strongly skewed to the right, with a very long right tail. A transformation by natural logs will both reduce the range of <code>log(size)</code> to one order of magnitude and shift the centre of the distribution of the covariate (Fig. <a href="#fig:transf">4</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:transf"></span>
<img src="Remedy-size-bias-for-dolphin-surveys_files/figure-html/transf-1.png" alt="Effect of log transformation upon distribution of observed group sizes."><p class="caption">
Figure 4: Effect of log transformation upon distribution of observed group sizes.
</p>
</div>
<p>The convergence problems associated with using <code>size</code> as a covariate in the detection function are alleviated as a result of the transformation.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr.clus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">nochopper</span>, key<span class="op">=</span><span class="st">"hr"</span>, formula <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Model contains covariate term(s): no adjustment terms will be included.</span></span></code></pre>
<pre><code><span><span class="co">## Fitting hazard-rate key function</span></span></code></pre>
<pre><code><span><span class="co">## AIC= 2904.307</span></span></code></pre>
<p>Having successfully incorporated group size into the detection function, we proceed to examine the consequence of using <code>Search.method</code> as a covariate and a model incorporating both covariates.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr.method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">nochopper</span>, key<span class="op">=</span><span class="st">"hr"</span>, formula <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Search.method</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hr.clus.method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">nochopper</span>, key<span class="op">=</span><span class="st">"hr"</span>, formula <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Search.method</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-10">Table 7: </span><span id="tab:unnamed-chunk-10">Table 8: </span>Models with hazard rate key function fitted to tuna fishing vessel sightings of dolphins. Sightings from helicopter not included in modelling.
</caption>
<thead><tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Key function
</th>
<th style="text-align:left;">
Formula
</th>
<th style="text-align:right;">
C-vM p-value
</th>
<th style="text-align:right;">
<span class="math inline">\(\hat{P_a}\)</span>
</th>
<th style="text-align:right;">
se(<span class="math inline">\(\hat{P_a}\)</span>)
</th>
<th style="text-align:right;">
<span class="math inline">\(\Delta\)</span>AIC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">

</td>
<td style="text-align:left;">
Hazard-rate
</td>
<td style="text-align:left;">
~log(size)
</td>
<td style="text-align:right;">
0.465
</td>
<td style="text-align:right;">
0.551
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">

</td>
<td style="text-align:left;">
Hazard-rate
</td>
<td style="text-align:left;">
~log(size) + factor(Search.method)
</td>
<td style="text-align:right;">
0.458
</td>
<td style="text-align:right;">
0.547
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
2.604
</td>
</tr>
<tr>
<td style="text-align:left;">

</td>
<td style="text-align:left;">
Hazard-rate
</td>
<td style="text-align:left;">
~1
</td>
<td style="text-align:right;">
0.456
</td>
<td style="text-align:right;">
0.564
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
16.490
</td>
</tr>
<tr>
<td style="text-align:left;">

</td>
<td style="text-align:left;">
Hazard-rate
</td>
<td style="text-align:left;">
~factor(Search.method)
</td>
<td style="text-align:right;">
0.463
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
18.232
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="interpretation-of-findings">Interpretation of findings<a class="anchor" aria-label="anchor" href="#interpretation-of-findings"></a>
</h2>
<p>All of the fitted models using the hazard rate as the key function fit the data. In addition, note the estimates of <span class="math inline">\(\widehat{P_a}\)</span> for all four models. Inclusion of covariates has a negligible effect upon estimated detection probability. Despite a <span class="math inline">\(\Delta\)</span>AIC value &gt; 15, the model without covariates produces a virtually identical estimate of detection probability. This is another example of the remarkable property of pooling robustness of distance sampling estimators <span class="citation">(Rexstad, Buckland, Marshall, &amp; Borchers, 2023)</span>.</p>
<p>We discuss estimates of group and individual density from this data set. However, this data set does not accurately reflect survey effort. The <code>Effort</code> column is filled with <code>1</code> and there is only a single transect labelled in the data. Hence, the density estimates do not reflect biological reality; nevertheless the comparisons between models are legitimate. Variability between transects is also not properly incorporated into this analysis, so I wonâ€™t present measures of precision associated with any of the following point estimates.</p>
<p>This slight variation in <span class="math inline">\(\widehat{P_a}\)</span> among the hazard rate candidate models is reflected in the equally similar estimates of dolphin pod density among the competing models. The model with the largest <span class="math inline">\(\widehat{P_a}\)</span> produces the lowest estimate of <span class="math inline">\(\widehat{D_s}\)</span> (170.5); while the model with the smallest <span class="math inline">\(\widehat{P_a}\)</span> produces the largest estimate of <span class="math inline">\(\widehat{D_s}\)</span> (175.8).</p>
<p>However, the most important consideration in analysis of this data set is proper treatment of size bias. The hazard rate models without group size in the detection function, estimate average group size in the population to be 515 whereas the model incorporating group size in the detection function estimates average group size in the population to be 408. Based on the evidence presented in Fig. <a href="#fig:boxplot">2</a>, there is reason to believe that estimates of average group size without incorporating group size in the detection function results in a positively biased estimate of group size in the population. From the group size estimates under the two models, it appears the magnitude of that positive size bias in this data set is 26.2.</p>
<p>This difference in estimated average group size is magnified in the estimates of individual density <span class="math inline">\(\widehat{D_I}\)</span>. The model without covariates estimates <span class="math inline">\(\widehat{D_I}\)</span> = 87805 while the model with group size as a covariate estimates <span class="math inline">\(\widehat{D_I}\)</span> to be 71150.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Take home points:</p>
<ul>
<li>Before incorporating covariates into the detection function, do a thorough exploratory data analysis with lots of plots.</li>
<li>Make at least a preliminary decision regarding key functions to consider before building an extensive candidate model set.</li>
<li>For this data set, there is little difference in the fit of the detection functions through the inclusion of covariates (pooling robustness).<br>
</li>
<li>However, exploratory data analysis suggested that small dolphin groups were missed at large distances, resulting in size bias in the estimate of average group size in the population.</li>
<li>Incorporating group size as a covariate in the detection function reduced the estimate group size in the population by 26.2%. This reduction in estimated group size compensated for the size bias induced by the detection process.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-buckland_2001" class="csl-entry">
Buckland, S. T., Anderson, D. R., Burnham, K. P., Laake, J. L., Borchers, D. L., &amp; Thomas, L. (2001). <em>Introduction to distance sampling: Estimating abundance of biological populations</em>. <span>Oxford, New York</span>: Oxford University Press.
</div>
<div id="ref-swfc_2008" class="csl-entry">
Gerrodette, Tim. (2008). Estimates of 2006 dolphin abundance in the eastern tropical pacific, with revised estimates from 1986-2003. <em>NOAA-TM-NMFS-SWFSC;422</em>.
</div>
<div id="ref-gerrodette_2005" class="csl-entry">
Gerrodette, T., &amp; Forcada, J. (2005). Non-recovery of two spotted and spinner dolphin populations in the eastern tropical pacific ocean. <em>Marine Ecology Progress Series</em>, <em>291</em>, 1â€“21. <a href="https://doi.org/10.3354/meps291001" class="external-link">https://doi.org/10.3354/meps291001</a>
</div>
<div id="ref-rexstad2023" class="csl-entry">
Rexstad, E., Buckland, S., Marshall, L., &amp; Borchers, D. (2023). Pooling robustness in distance sampling: <span>Avoiding</span> bias when there is unmodelled heterogeneity. <em>Ecology and Evolution</em>, <em>13</em>(1), e9684. <a href="https://doi.org/10.1002/ece3.9684" class="external-link">https://doi.org/10.1002/ece3.9684</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer>
</div>





  
</body>
</html>
