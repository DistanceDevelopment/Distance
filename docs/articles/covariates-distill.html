<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Incorporating covariates in the detection function • Distance</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Incorporating covariates in the detection function">
<meta name="description" content="Hawaiian amakihi point transect data.
">
<meta property="og:description" content="Hawaiian amakihi point transect data.
">
</head>
<body>
<p>








  list(file = "Clarity.txt")

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Distance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lines-distill.html">Line transects</a></li>
    <li><a class="dropdown-item" href="../articles/covariates-distill.html">Covariates in detection</a></li>
    <li><a class="dropdown-item" href="../articles/species-covariate-distill.html">Species as a covariate</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Only for the website</h6></li>
    <li><a class="dropdown-item" href="../articles/web-only/points/pointtransects-distill.html">Point transects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.html">Size bias remedy</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/strata/strata-distill.html">Stratification</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/differences/differences.html">Detecting difference in density between strata</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/variance/variance-distill.html">Variance estimation with bootstrap</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/cues/cuecounts-distill.html">Cue count surveys</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/multipliers/multipliers-distill.html">Indirect surveys</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/multispecies/multispecies-multioccasion-analysis.html">Take care when subsetting multispecies data sets</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/CTDS/camera-distill.html">Camera trap distance sampling</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/alt-optimise/mcds-dot-exe.html">Alternative optimiser</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/Distance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Incorporating covariates in the detection function</h1>
                        <h4 data-toc-skip class="author">Eric Rexstad</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">November 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/Distance/blob/HEAD/vignettes/covariates-distill.Rmd" class="external-link"><code>vignettes/covariates-distill.Rmd</code></a></small>
      <div class="d-none name"><code>covariates-distill.Rmd</code></div>
    </address>
</div>

    
    
<p>In this problem, we illustrate fitting multiple covariate distance sampling (MCDS) models to point transect data using a bird survey from Hawaii: data on an abundant species, the Hawaii amakihi <em>(Hemignathus virens)</em> is used. This practical is makes use of the <code>Distance</code> R package described by Miller et al. <span class="citation">(2019)</span> duplicating the analysis in Marques et al. <span class="citation">(2007)</span>. For basic information regarding analysis of point transect data, consult the <a href="https://examples.distancesampling.org/Distance-points/pointtransects-distill.html" class="external-link">point transect example</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/Distance/" class="external-link">Distance</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">amakihi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">amakihi</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Region.Label Area Sample.Label Effort object distance Month OBs   Sp MAS HAS</span></span>
<span><span class="co">## 1          792    0            1      1      1       40     0 TJS COAM  50   1</span></span>
<span><span class="co">## 2          792    0            1      1      2       60     0 TJS COAM  50   1</span></span>
<span><span class="co">## 3          792    0            1      1      3       45     0 TJS COAM  50   1</span></span>
<span><span class="co">##   Study.Area</span></span>
<span><span class="co">## 1       Kana</span></span>
<span><span class="co">## 2       Kana</span></span>
<span><span class="co">## 3       Kana</span></span></code></pre>
<p>These data include:</p>
<ul>
<li>
<code>Region.Label</code> - survey dates (month and year, e.g. 792 is July 1992) which are used as ‘strata’</li>
<li>
<code>Area</code> - study area size (not used, set to 0) will only produce density estimates, not abundance</li>
<li>
<code>Sample.Label</code> - point transect identifier (41 transects)</li>
<li>
<code>Effort</code> - survey effort (1 for all points because each point was visited once)</li>
<li>
<code>distance</code> - radial distance of detection from observer (meters)</li>
<li>
<code>month</code> -</li>
<li>
<code>OBs</code> - initials of the observer</li>
<li>
<code>Sp</code> - species code (COAM)</li>
<li>
<code>MAS</code> - minutes after sunrise</li>
<li>
<code>HAS</code> - hour after sunrise</li>
<li>
<code>Study.Area</code> - name of the study area (Kana)</li>
</ul>
<p>Note that the <code>Area</code> column is always zero, hence, detection functions can be fitted to the data, but bird abundance cannot be estimated. The covariates to be considered for possible inclusion into the detection function are <code>OBs</code>, <code>MAS</code> and <code>HAS</code>.</p>
<div class="section level2">
<h2 id="exploratory-data-analysis">Exploratory data analysis<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis"></a>
</h2>
<p>It is important to gain an understanding of the data prior to fitting detection functions. With this in mind, preliminary analysis of distance sampling data involves:</p>
<ul>
<li>assessing the shape of the collected data,</li>
<li>considering the level of truncation of distances, and</li>
<li>exploring patterns in potential covariates.</li>
</ul>
<p>We begin by assessing the distribution of distances to decide on a truncation distance (Figure <a href="#fig:basic">1</a>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">amakihi</span><span class="op">$</span><span class="va">distance</span>, main<span class="op">=</span><span class="st">"Radial distances"</span>, xlab<span class="op">=</span><span class="st">"Distance (m)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:basic"></span>
<img src="covariates-distill_files/figure-html/basic-1.png" alt="Distribution of radial distances of amakihi"><p class="caption">
Figure 1: Distribution of radial distances of amakihi
</p>
</div>
<p>To see if there are differences in the distribution of distances recorded by the different observers and in each hour after sunrise, boxplots can be used. Note how the <code>~</code> symbol is used to define the discrete groupings (i.e. observer and hour) (Figure <a href="#fig:box">2</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">amakihi</span><span class="op">$</span><span class="va">distance</span><span class="op">~</span><span class="va">amakihi</span><span class="op">$</span><span class="va">OBs</span>, xlab<span class="op">=</span><span class="st">"Observer"</span>, ylab<span class="op">=</span><span class="st">"Distance (m)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">amakihi</span><span class="op">$</span><span class="va">distance</span><span class="op">~</span><span class="va">amakihi</span><span class="op">$</span><span class="va">HAS</span>, xlab<span class="op">=</span><span class="st">"Hour"</span>, ylab<span class="op">=</span><span class="st">"Distance (m)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:box"></span>
<img src="covariates-distill_files/figure-html/box-1.png" alt="Visual assessment of effect of observer and hour since sunrise upon detection."><img src="covariates-distill_files/figure-html/box-2.png" alt="Visual assessment of effect of observer and hour since sunrise upon detection."><p class="caption">
Figure 2: Visual assessment of effect of observer and hour since sunrise upon detection.
</p>
</div>
<p>The components of the boxplot are:</p>
<ul>
<li>the thick black line indicates the median</li>
<li>the lower limit of the box is the first quartile (25th percentile) and the upper limit is the third quartile (75th percentile)</li>
<li>the height of the box is the interquartile range (75th - 25th quartiles)</li>
<li>the whiskers extend to the most extreme points which are no more than 1.5 times the interquartile range.</li>
<li>dots indicate ‘outliers’ if there are any, i.e. points beyond the range of the whiskers.</li>
</ul>
<p>For minutes after sunrise (a continuous variable), we create a scatterplot of MAS (on the <span class="math inline">\(x\)</span>-axis) against distances (on the <span class="math inline">\(y\)</span>-axis). The plotting symbol (or character) is selected with the argument <code>pch</code> (Figure <a href="#fig:scatter">3</a>)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/scatter.smooth.html" class="external-link">scatter.smooth</a></span><span class="op">(</span><span class="va">amakihi</span><span class="op">$</span><span class="va">MAS</span>, <span class="va">amakihi</span><span class="op">$</span><span class="va">distance</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, pch<span class="op">=</span><span class="fl">20</span>, cex<span class="op">=</span><span class="fl">.9</span>, lpars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>               xlab<span class="op">=</span><span class="st">"Minutes after sunrise"</span>,ylab<span class="op">=</span><span class="st">"Distance (m)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:scatter"></span>
<img src="covariates-distill_files/figure-html/scatter-1.png" alt="Visualisation of detectability as function of minutes since sunrise."><p class="caption">
Figure 3: Visualisation of detectability as function of minutes since sunrise.
</p>
</div>
<p>Clearly room for right truncation from this figure of the radial distance distribution. Subsequent detection function fitting will use the <code>truncation</code> argument in <code><a href="../reference/ds.html">ds()</a></code> to exclude the largest 15% of the detection distances.</p>
<p>You may also want to think about potential collinearity (linear relationship) between the covariates - if collinear variables are included in the detection function, they will be explaining some of the same variation in the distances and this will reduce their importance as a potential covariate. How might you investigate the relationship between <code>HAS</code> and <code>MAS</code>?</p>
<p>From these plots, infer whether any of the covariates will be useful in explaining the distribution of detection distances.</p>
</div>
<div class="section level2">
<h2 id="adjusting-the-raw-covariates">Adjusting the raw covariates<a class="anchor" aria-label="anchor" href="#adjusting-the-raw-covariates"></a>
</h2>
<p>We would like to treat <code>OBs</code> and <code>HAS</code> as factor variables as in the original analysis; <code>OBs</code> is, by default, treated as a factor variable because it consists of characters rather than numbers. <code>HAS</code>, on the other hand, consists of numbers and so by default would be treated as a continuous variable (i.e. non-factor). That is fine if we want the effect of <code>HAS</code> to be monotonic (i.e. detectability either increases or decreases as a function of <code>HAS</code>). If we want <code>HAS</code> to have a non-linear effect on detectability, then we need to indicate to <code>R</code> to treat it as a factor as shown below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amakihi</span><span class="op">$</span><span class="va">HAS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">amakihi</span><span class="op">$</span><span class="va">HAS</span><span class="op">)</span></span></code></pre></div>
<p>One other, more subtle adjustment, is a transformation of the continuous covariate <code>MAS</code>. We are considering three possible covariates in our detection function: <code>OBs</code>, <code>HAS</code> and <code>MAS</code>. The first two variables, <code>OBs</code> and <code>HAS</code>, are both factor variables, and so, essentially, we can think of them as taking on values between 1 and 3 in the case of <code>OBS</code>, and 1 to 6 in the case of <code>HAS</code>. However, <code>MAS</code> can take on values from -18 (detections before sunrise) to &gt;300 and the disparity in scales of measure between <code>MAS</code> and the other candidate covariates can lead to difficulties in the performance of the optimizer fitting the detection functions in R. The solution to the difficulty is to scale <code>MAS</code> such that it is on a scale (approx. 1 to 5) comparable with the other covariates.</p>
</div>
<div class="section level2">
<h2 id="candidate-models">Candidate models<a class="anchor" aria-label="anchor" href="#candidate-models"></a>
</h2>
<p>With three potential covariates, there are 8 possible models for the detection function:</p>
<ul>
<li>No covariates</li>
<li>OBs</li>
<li>HAS</li>
<li>MAS</li>
<li>OBs + HAS</li>
<li>OBs + MAS</li>
<li>HAS + MAS</li>
<li>OBs + HAS + MAS</li>
</ul>
<p>Even without considering covariates there are also several possible key function/adjustment term combinations available: if all key function/covariate combinations are considered the number of potential models is large. Note that covariates are not allowed if a uniform key function is chosen and if covariate terms are included, adjustment terms are not allowed. Even with these restrictions, it is not best practice to take a scatter gun approach to detection function model fitting. Buckland et al. <span class="citation">(2015)</span> considered 13 combinations of key function/covariates. Here, we look at a subset of these.</p>
<p>Fit a hazard rate model with no covariates or adjustment terms and make a note of the AIC. Note, that 15% of the largest distances are truncated - you may have decided on a different truncation distance.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conversion.factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_units.html">convert_units</a></span><span class="op">(</span><span class="st">"meter"</span>, <span class="cn">NULL</span>, <span class="st">"hectare"</span><span class="op">)</span></span>
<span><span class="va">amak.hr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">amakihi</span>, transect<span class="op">=</span><span class="st">"point"</span>, key<span class="op">=</span><span class="st">"hr"</span>, truncation<span class="op">=</span><span class="st">"15%"</span>,</span>
<span>              adjustment<span class="op">=</span><span class="cn">NULL</span>, convert_units <span class="op">=</span> <span class="va">conversion.factor</span><span class="op">)</span></span></code></pre></div>
<p>Now fit a hazard rate model with <code>OBs</code> as a covariate in the detection function and make a note of the AIC. Has the AIC reduced by including a covariate?</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amak.hr.obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">amakihi</span>, transect<span class="op">=</span><span class="st">"point"</span>, key<span class="op">=</span><span class="st">"hr"</span>, formula<span class="op">=</span><span class="op">~</span><span class="va">OBs</span>,</span>
<span>                  truncation<span class="op">=</span><span class="st">"15%"</span>, convert_units <span class="op">=</span> <span class="va">conversion.factor</span><span class="op">)</span></span></code></pre></div>
<p>Fit a hazard rate model with <code>OBs</code> and <code>MAS</code> in the detection function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amak.hr.obs.mas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">amakihi</span>, transect<span class="op">=</span><span class="st">"point"</span>, key<span class="op">=</span><span class="st">"hr"</span>, formula<span class="op">=</span><span class="op">~</span><span class="va">OBs</span><span class="op">+</span><span class="va">MAS</span>,</span>
<span>                      truncation<span class="op">=</span><span class="st">"15%"</span>, convert_units <span class="op">=</span> <span class="va">conversion.factor</span><span class="op">)</span></span></code></pre></div>
<p>Try fitting other possible formula and decide which model is best in terms of AIC. To quickly compare AIC values from different models, use the <code>AIC</code> command as follows (note only models with the same truncation distance can be compared):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">amak.hr</span>, <span class="va">amak.hr.obs</span>, <span class="va">amak.hr.obs.mas</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 df      AIC</span></span>
<span><span class="co">## amak.hr          2 11400.47</span></span>
<span><span class="co">## amak.hr.obs      4 11368.20</span></span>
<span><span class="co">## amak.hr.obs.mas  5 11365.96</span></span></code></pre>
<p>Another useful function is <code>summarize_ds_models</code> - this has the advantage of ordering the models by AIC (smallest to largest).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/summarize_ds_models.html">summarize_ds_models</a></span><span class="op">(</span><span class="va">amak.hr</span>, <span class="va">amak.hr.obs</span>, <span class="va">amak.hr.obs.mas</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span>,</span>
<span>             caption<span class="op">=</span><span class="st">"Model selection table for Hawaiian amakihi."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-8">Table 1: </span>Model selection table for Hawaiian amakihi.</caption>
<colgroup>
<col width="2%">
<col width="23%">
<col width="12%">
<col width="10%">
<col width="12%">
<col width="11%">
<col width="15%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Model</th>
<th align="left">Key function</th>
<th align="left">Formula</th>
<th align="right">C-vM p-value</th>
<th align="right"><span class="math inline">\(\hat{P_a}\)</span></th>
<th align="right">se(<span class="math inline">\(\hat{P_a}\)</span>)</th>
<th align="right">
<span class="math inline">\(\Delta\)</span>AIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">3</td>
<td align="left"></td>
<td align="left">Hazard-rate</td>
<td align="left">~OBs + MAS</td>
<td align="right">0.170</td>
<td align="right">0.302</td>
<td align="right">0.022</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left"></td>
<td align="left">Hazard-rate</td>
<td align="left">~OBs</td>
<td align="right">0.116</td>
<td align="right">0.297</td>
<td align="right">0.022</td>
<td align="right">2.249</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left"></td>
<td align="left">Hazard-rate</td>
<td align="left">~1</td>
<td align="right">0.144</td>
<td align="right">0.308</td>
<td align="right">0.022</td>
<td align="right">34.516</td>
</tr>
</tbody>
</table>
<p>Examine the shape of the preferred detection function (including covariates observer and minutes after sunrise) (Figure <a href="#fig:bestmod">4</a>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">amak.hr.obs.mas</span>, pdf<span class="op">=</span><span class="cn">TRUE</span>, main<span class="op">=</span><span class="st">"Hazard rate with observer and minutes after sunrise."</span>, showpoints<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sfzero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>OBs<span class="op">=</span><span class="st">"SGF"</span>, MAS<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">sf180</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>OBs<span class="op">=</span><span class="st">"SGF"</span>, MAS<span class="op">=</span><span class="fl">180</span><span class="op">)</span></span>
<span><span class="va">t1zero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>OBs<span class="op">=</span><span class="st">"TJS"</span>, MAS<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">t1180</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>OBs<span class="op">=</span><span class="st">"TJS"</span>, MAS<span class="op">=</span><span class="fl">180</span><span class="op">)</span></span>
<span><span class="va">t2zero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>OBs<span class="op">=</span><span class="st">"TKP"</span>, MAS<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">t2180</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>OBs<span class="op">=</span><span class="st">"TKP"</span>, MAS<span class="op">=</span><span class="fl">180</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_df_covar_line.html">add_df_covar_line</a></span><span class="op">(</span><span class="va">amak.hr.obs.mas</span>, data<span class="op">=</span><span class="va">sfzero</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"blue"</span>, pdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_df_covar_line.html">add_df_covar_line</a></span><span class="op">(</span><span class="va">amak.hr.obs.mas</span>, data<span class="op">=</span><span class="va">sf180</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"blue"</span>, pdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_df_covar_line.html">add_df_covar_line</a></span><span class="op">(</span><span class="va">amak.hr.obs.mas</span>, data<span class="op">=</span><span class="va">t1zero</span>, lty<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"darkorange"</span>, pdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_df_covar_line.html">add_df_covar_line</a></span><span class="op">(</span><span class="va">amak.hr.obs.mas</span>, data<span class="op">=</span><span class="va">t1180</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"darkorange"</span>, pdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_df_covar_line.html">add_df_covar_line</a></span><span class="op">(</span><span class="va">amak.hr.obs.mas</span>, data<span class="op">=</span><span class="va">t2zero</span>, lty<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"violet"</span>, pdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_df_covar_line.html">add_df_covar_line</a></span><span class="op">(</span><span class="va">amak.hr.obs.mas</span>, data<span class="op">=</span><span class="va">t2180</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"violet"</span>, pdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SF, minutes=0"</span>,</span>
<span>                            <span class="st">"SF, minutes=180"</span>,</span>
<span>                            <span class="st">"TS, minutes=0"</span>,</span>
<span>                            <span class="st">"TS, minutes=180"</span>,</span>
<span>                            <span class="st">"TP, minutes=0"</span>,</span>
<span>                            <span class="st">"TP, minutes=180"</span><span class="op">)</span>,</span>
<span>       title<span class="op">=</span><span class="st">"Covariate combination: observer and minutes"</span>,</span>
<span>       lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,times<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"darkorange"</span>,<span class="st">"violet"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:bestmod"></span>
<img src="covariates-distill_files/figure-html/bestmod-1.png" alt="PDF of best fitting model, including effects of observer and minutes after sunrise."><p class="caption">
Figure 4: PDF of best fitting model, including effects of observer and minutes after sunrise.
</p>
</div>
</div>
<div class="section level2">
<h2 id="comments-about-the-chosen-model">Comments about the chosen model<a class="anchor" aria-label="anchor" href="#comments-about-the-chosen-model"></a>
</h2>
<p>There were three observers involved in the survey. One observer made ~80% of the detections, with a second observer responsible for a further 15% and the third observer 5%.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-buckland2015distance" class="csl-entry">
Buckland, S., Rexstad, E., Marques, T., &amp; Oedekoven, C. (2015). <em>Distance sampling: Methods and applications</em>. Springer.
</div>
<div id="ref-Maretal07" class="csl-entry">
Marques, T. A., Thomas, L., Fancy, S. G., &amp; Buckland, S. T. (2007). Improving estimates of bird density using multiple covariate distance sampling. <em>The Auk</em>, <em>124</em>, 1229–1243. <a href="https://doi.org/10.1642/0004-8038(2007)124%5B1229:IEOBDU%5D2.0.CO;2" class="external-link">https://doi.org/10.1642/0004-8038(2007)124[1229:IEOBDU]2.0.CO;2</a>
</div>
<div id="ref-miller_distance_2019" class="csl-entry">
Miller, D. L., Rexstad, E., Thomas, L., Marshall, L., &amp; Laake, J. L. (2019). Distance sampling in r. <em>Journal of Statistical Software</em>, <em>89</em>(1), 1–28. <a href="https://doi.org/10.18637/jss.v089.i01" class="external-link">https://doi.org/10.18637/jss.v089.i01</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance</p>
</div>

    </footer>
</div>





  
</body>
</html>
