<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Example analysis of line transect data.
">
<title>Line transect density estimation • Distance</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Line transect density estimation">
<meta property="og:description" content="Example analysis of line transect data.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
<p>



  list(file = "Clarity.txt")

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Distance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lines-distill.html">Line transects</a>
    <a class="dropdown-item" href="../articles/covariates-distill.html">Covariates in detection</a>
    <a class="dropdown-item" href="../articles/species-covariate-distill.html">Species as a covariate</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Only for the website</h6>
    <a class="dropdown-item" href="../articles/web-only/points/pointtransects-distill.html">Point transects</a>
    <a class="dropdown-item" href="../articles/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.html">Size bias remedy</a>
    <a class="dropdown-item" href="../articles/web-only/strata/strata-distill.html">Stratification</a>
    <a class="dropdown-item" href="../articles/web-only/differences/differences.html">Detecting difference in density between strata</a>
    <a class="dropdown-item" href="../articles/web-only/variance/variance-distill.html">Variance estimation with bootstrap</a>
    <a class="dropdown-item" href="../articles/web-only/cues/cuecounts-distill.html">Cue count surveys</a>
    <a class="dropdown-item" href="../articles/web-only/multipliers/multipliers-distill.html">Indirect surveys</a>
    <a class="dropdown-item" href="../articles/web-only/multispecies/multispecies-multioccasion-analysis.html">Take care when subsetting multispecies data sets</a>
    <a class="dropdown-item" href="../articles/web-only/CTDS/camera-distill.html">Camera trap distance sampling</a>
    <a class="dropdown-item" href="../articles/web-only/alt-optimise/mcds-dot-exe.html">Alternative optimiser</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DistanceDevelopment/Distance/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Line transect density estimation</h1>
                        <h4 data-toc-skip class="author">Eric Rexstad</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">May 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/Distance/blob/HEAD/vignettes/lines-distill.Rmd" class="external-link"><code>vignettes/lines-distill.Rmd</code></a></small>
      <div class="d-none name"><code>lines-distill.Rmd</code></div>
    </address>
</div>

    
    
<p>In this exercise, we use <code>R</code> <span class="citation">(R Core Team, 2019)</span> and the <code>Distance</code> package <span class="citation">(Miller, Rexstad, Thomas, Marshall, &amp; Laake, 2019)</span> to fit different detection function models to line transect survey data of winter wren <em>(Troglodytes troglodytes)</em> density and abundance. These data were part of a study described by Buckland <span class="citation">(2006)</span>.</p>
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<ul>
<li>Import a data file</li>
<li>Fit a basic detection function using the <code>ds</code> function</li>
<li>Plot and examine a detection function</li>
<li>Fit different detection function forms.</li>
</ul>
</div>
<div class="section level2">
<h2 id="survey-design">Survey design<a class="anchor" aria-label="anchor" href="#survey-design"></a>
</h2>
<p>Nineteen line transects were walked twice (Figure <a href="#fig:fig">1</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:fig"></span>
<img src="montrave.jpg" alt="Montrave study area; diagonal lines indicate line transects walked to generate these data." width="499"><p class="caption">
Figure 1: Montrave study area; diagonal lines indicate line transects walked to generate these data.
</p>
</div>
<p>The fields of the <code>wren_lt</code> data set are:</p>
<ul>
<li>Region.Label - identifier of regions: in this case there is only one region and set to ‘Montrave’ <strong>required field</strong>
</li>
<li>Area - size of the study region (hectares): 33.2ha</li>
<li>Sample.Label - line transect identifier (numbered 1-19) <strong>required field</strong>
</li>
<li>Effort - length of the line transects (km) <strong>required field</strong>
</li>
<li>object - unique identifier for each detected winter wren</li>
<li>distance - perpendicular distance (metres) to each detection <strong>required field</strong>
</li>
<li>Study.Area - this is the name of the study, ‘Montrave 4’</li>
</ul>
</div>
<div class="section level2">
<h2 id="make-the-data-available-for-r-session">Make the data available for R session<a class="anchor" aria-label="anchor" href="#make-the-data-available-for-r-session"></a>
</h2>
<p>This command assumes that the <code>Distance</code> package has been installed on your computer. The R workspace <code>wren_lt</code> contains detections of winter wrens from the line transect surveys of Buckland <span class="citation">(2006)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/Distance/" class="external-link">Distance</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wren_lt</span><span class="op">)</span></span></code></pre></div>
<p>The effort, or transect length has been adjusted to recognise each transect is walked twice. Examine the first few rows of <code>wren_lt</code> using the function <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">wren_lt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Region.Label Area Sample.Label Effort object distance Study.Area</span></span>
<span><span class="co">## 1     Montrave 33.2            1  0.416      5       15 Montrave 4</span></span>
<span><span class="co">## 2     Montrave 33.2            1  0.416      6       80 Montrave 4</span></span>
<span><span class="co">## 3     Montrave 33.2            1  0.416      7       35 Montrave 4</span></span>
<span><span class="co">## 4     Montrave 33.2            1  0.416      8       55 Montrave 4</span></span>
<span><span class="co">## 5     Montrave 33.2            1  0.416     12       12 Montrave 4</span></span>
<span><span class="co">## 6     Montrave 33.2            1  0.416     13       75 Montrave 4</span></span></code></pre>
<p>The object <code>wren_lt</code> is a dataframe object made up of rows and columns.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">wren_lt</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 156</span></span></code></pre>
<p>The code above determines the number of detection distances that are not missing. Why might there be rows in our data where detection distance is missing? Distance would have to be recorded as missing for rows representing transects on which there were no detections. The transect and its effort would need to appear in the data, but without detections, the perpendicular distance would be recorded as missing (NA).</p>
</div>
<div class="section level2">
<h2 id="examine-the-distribution-of-detection-distances">Examine the distribution of detection distances<a class="anchor" aria-label="anchor" href="#examine-the-distribution-of-detection-distances"></a>
</h2>
<p>Gain familiarity with the perpendicular distance data using the <code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code> function (Figure <a href="#fig:basichist">2</a>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">wren_lt</span><span class="op">$</span><span class="va">distance</span>, xlab<span class="op">=</span><span class="st">"Distance (m)"</span>, main<span class="op">=</span><span class="st">"Winter wren line transects"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:basichist"></span>
<img src="lines-distill_files/figure-html/basichist-1.png" alt="Distribution of perpendicular distances for winter wren from [@Buckland2006]."><p class="caption">
Figure 2: Distribution of perpendicular distances for winter wren from <span class="citation">(Buckland, 2006)</span>.
</p>
</div>
<p>Note that there appears to be too few detections between 0 and 20m, and too many detections between 20m and 40m. This may be evidence of evasive movement by winter wrens; <a href="#model-selection-is-not-a-cookbook">see further discussion of this below</a>.</p>
</div>
<div class="section level2">
<h2 id="specify-unit-conversions">Specify unit conversions<a class="anchor" aria-label="anchor" href="#specify-unit-conversions"></a>
</h2>
<blockquote>
<p>A guaranteed way to produce incorrect results from your analysis is to misspecify the units distances are measured. The <code>ds</code> function has an argument <code>convert.units</code> where the user provides a value to report density in proper units. Providing an incorrect value will result in estimates that are out by orders of magnitude.</p>
</blockquote>
<p>We can choose the units in which winter wren density is to be reported, we choose <em>square kilometre</em>. How to transmit this information to the <code>ds</code> function?</p>
<p>The answer is another function <code>convert_units</code>. Arguments to this function are</p>
<ul>
<li>distance_units
<ul>
<li>units of measure for perpendicular/radial distances</li>
</ul>
</li>
<li>effort_units
<ul>
<li>units of measure for effort (NULL for point transects)</li>
</ul>
</li>
<li>area_units
<ul>
<li>units of measure for the study area.</li>
</ul>
</li>
</ul>
<p>Specify the correct arguments to this function for the winter wren data set. <em>Note</em>: units are specified as quoted strings, singular rather than plural; e.g. “meter” rather than “meters”</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conversion.factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_units.html">convert_units</a></span><span class="op">(</span><span class="st">"meter"</span>, <span class="st">"kilometer"</span>, <span class="st">"hectare"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-a-simple-detection-function-model-with-ds">Fitting a simple detection function model with <code>ds</code><a class="anchor" aria-label="anchor" href="#fitting-a-simple-detection-function-model-with-ds"></a>
</h2>
<p>Detection functions are fitted using the <code>ds</code> function and this function requires a data frame to have a column called <code>distance</code>. We have this in our <code>nests</code> data, therefore, we can simply supply the name of the data frame to the function along with additional arguments.</p>
<p>Details about the arguments for this function:</p>
<ul>
<li>
<code>key="hn"</code>
<ul>
<li>fit a half-normal key detection function</li>
</ul>
</li>
<li>
<code>adjustment=NULL</code>
<ul>
<li>do not include adjustment terms</li>
</ul>
</li>
<li>
<code>convert_units=conversion.factor</code>
<ul>
<li>required because, for this example, the perpendicular distances are in metres and the line transect lengths are in kilometer - this argument converts the perpendicular distance measurements from metres to kilometer. Our density estimates will be reported in number of birds per hectare.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wren.hn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.html">ds</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">wren_lt</span>, key<span class="op">=</span><span class="st">"hn"</span>, adjustment<span class="op">=</span><span class="cn">NULL</span>, convert_units<span class="op">=</span><span class="va">conversion.factor</span><span class="op">)</span></span></code></pre></div>
<p>On calling the <code>ds</code> function, information is provided to the screen reminding the user what model has been fitted and the associated AIC value. More information is supplied by applying the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function to the object created by <code><a href="../reference/ds.html">ds()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wren.hn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for distance analysis </span></span>
<span><span class="co">## Number of observations :  156 </span></span>
<span><span class="co">## Distance range         :  0  -  100 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model       : Half-normal key function </span></span>
<span><span class="co">## AIC         :  1418.188 </span></span>
<span><span class="co">## Optimisation:  mrds (nlminb) </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection function parameters</span></span>
<span><span class="co">## Scale coefficient(s):  </span></span>
<span><span class="co">##             estimate        se</span></span>
<span><span class="co">## (Intercept) 4.105816 0.1327744</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                       Estimate          SE         CV</span></span>
<span><span class="co">## Average p             0.685037  0.05678821 0.08289802</span></span>
<span><span class="co">## N in covered region 227.724931 21.47275208 0.09429250</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary statistics:</span></span>
<span><span class="co">##     Region Area CoveredArea Effort   n  k       ER    se.ER      cv.ER</span></span>
<span><span class="co">## 1 Montrave 33.2       193.2   9.66 156 19 16.14907 1.226096 0.07592366</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Abundance:</span></span>
<span><span class="co">##   Label Estimate       se        cv     lcl     ucl       df</span></span>
<span><span class="co">## 1 Total 39.13286 4.399007 0.1124121 31.3023 48.9223 74.24595</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##   Label Estimate        se        cv       lcl      ucl       df</span></span>
<span><span class="co">## 1 Total   1.1787 0.1325002 0.1124121 0.9428403 1.473563 74.24595</span></span></code></pre>
<div class="section level3">
<h3 id="the-summary-function">The <code>summary</code> function<a class="anchor" aria-label="anchor" href="#the-summary-function"></a>
</h3>
<p>Examining the output produced by <code>summary(wren.hn)</code> notice</p>
<ul>
<li>number of detections used in fitting</li>
<li>truncation distances</li>
<li>AIC score</li>
<li>parameters of the detection function (on a natural log scale)</li>
<li>estimated probability of detection within the truncation distance</li>
<li>estimated number of objects in the area covered by survey effort</li>
<li>summary of the survey (effort, number of transects, number of detections)
<ul>
<li>encounter rate and its variability</li>
</ul>
</li>
<li>estimated abundance and density within the study area
<ul>
<li>and measures of precision</li>
</ul>
</li>
<li>if there are strata, estimates are provided for each stratum</li>
<li>if objects were detected in groups, there are estimates of abundance of groups and of individuals</li>
</ul>
<p>Visually inspect the fitted detection function with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function, specifying the cutpoints histogram with argument <code>breaks</code> (Figure <a href="#fig:hnfitted">3</a>):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutpoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">65</span>,<span class="fl">80</span>,<span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wren.hn</span>, breaks<span class="op">=</span><span class="va">cutpoints</span>, main<span class="op">=</span><span class="st">"Half normal model, wren line transects"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:hnfitted"></span>
<img src="lines-distill_files/figure-html/hnfitted-1.png" alt="Fit of half normal detection function to wren data.  Note large number of break points specified at small distances."><p class="caption">
Figure 3: Fit of half normal detection function to wren data. Note large number of break points specified at small distances.
</p>
</div>
<p>Continue to note the presence of evasive movement in this plot of the fit of detection function to the observed data.</p>
</div>
</div>
<div class="section level2">
<h2 id="specifying-different-detection-functions">Specifying different detection functions<a class="anchor" aria-label="anchor" href="#specifying-different-detection-functions"></a>
</h2>
<p>Detection function forms and shapes, are specified by changing the <code>key</code> and <code>adjustment</code> arguments.</p>
<p>The options available for <code>key</code> detection functions are:</p>
<ul>
<li>half normal (<code>key="hn"</code>) - default</li>
<li>hazard rate (<code>key="hr"</code>)</li>
<li>uniform (<code>key="unif"</code>)</li>
</ul>
<p>The options available for adjustment terms are:</p>
<ul>
<li>no adjustment terms (<code>adjustment=NULL</code>)</li>
<li>cosine (<code>adjustment="cos"</code>) - default</li>
<li>Hermite polynomial (<code>adjustment="herm"</code>)</li>
<li>Simple polynomial (<code>adjustment="poly"</code>)</li>
</ul>
<p>To fit a uniform key function with cosine adjustment terms, use the command:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wren.unif.cos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">wren_lt</span>, key<span class="op">=</span><span class="st">"unif"</span>, adjustment<span class="op">=</span><span class="st">"cos"</span>, convert_units<span class="op">=</span><span class="va">conversion.factor</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in check.mono(result, n.pts = control$mono.points): Detection function</span></span>
<span><span class="co">## is not strictly monotonic!</span></span>
<span><span class="co">## Warning in check.mono(result, n.pts = control$mono.points): Detection function</span></span>
<span><span class="co">## is not strictly monotonic!</span></span></code></pre>
<pre><code><span><span class="co">## Warning in mrds::check.mono(model, n.pts = 20): Detection function is not</span></span>
<span><span class="co">## strictly monotonic!</span></span></code></pre>
<p>When this line of code is executed, multiple models will be fitted, successively adding addition adjustment terms. When the model with four adjustment terms is fit, an error message is returned; but a uniform key with 3 cosine adjustments is fitted and contained in the returned object.</p>
<p>AIC model selection will be used to fit adjustment terms of up to order 5.</p>
<p>To fit a hazard rate key function with simple polynomial adjustment terms, then use the command:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wren.hr.poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ds.html">ds</a></span><span class="op">(</span><span class="va">wren_lt</span>, key<span class="op">=</span><span class="st">"hr"</span>, adjustment<span class="op">=</span><span class="st">"poly"</span>, convert_units<span class="op">=</span><span class="va">conversion.factor</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>Each fitted detection function produces a different estimate of winter wren abundance and density. The estimate depends upon the model chosen. The model selection tool for distance sampling data is AIC.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">wren.hn</span>, <span class="va">wren.hr.poly</span>, <span class="va">wren.unif.cos</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               df      AIC</span></span>
<span><span class="co">## wren.hn        1 1418.188</span></span>
<span><span class="co">## wren.hr.poly   2 1412.133</span></span>
<span><span class="co">## wren.unif.cos  3 1416.430</span></span></code></pre>
<p><code>df</code> in the AIC table indicates the number of parameters associated with each model.</p>
<div class="section level3">
<h3 id="absolute-goodness-of-fit">Absolute goodness of fit<a class="anchor" aria-label="anchor" href="#absolute-goodness-of-fit"></a>
</h3>
<p>In addition to the relative ranking of models provided by AIC, it is also important to know whether selected model(s) actually fit the data. The model is the basis of inference, so it is dangerous to make inference from a model that does not fit the data. Goodness of fit is assessed using the function <code>gof_ds</code>. This function by default, reports the goodness of fit assessed by the Cramer von-Mises test along with a quantile-quantile plot showing locations of deviations from good fit. Optionally, a <span class="math inline">\(\chi^2\)</span> goodness of fit test and a bootstrap version of the Kolomogorov-Smirnov goodness of fit test can be performed. Using function defaults, we see results only of the Cramer von-Mises test along with the Q-Q plot (Figure <a href="#fig:qq">4</a>).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gof_ds.html">gof_ds</a></span><span class="op">(</span><span class="va">wren.hr.poly</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:qq"></span>
<img src="lines-distill_files/figure-html/qq-1.png" alt="Q-Q plot of hazard rate key function fitted ot wren line transect data."><p class="caption">
Figure 4: Q-Q plot of hazard rate key function fitted ot wren line transect data.
</p>
</div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Goodness of fit results for ddf object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Distance sampling Cramer-von Mises test (unweighted)</span></span>
<span><span class="co">## Test statistic = 0.249898 p-value = 0.1885</span></span></code></pre>
<p>Even though there may have been evasive movement, the goodness of fit statistics are still sufficient for using detection function models for inference.</p>
</div>
</div>
<div class="section level2">
<h2 id="model-comparison-tables">Model comparison tables<a class="anchor" aria-label="anchor" href="#model-comparison-tables"></a>
</h2>
<p>The function <code>summarise_ds_models</code> combines the work of <code>AIC</code> and <code>gof_ds</code> to produce a table of fitted models and summary statistics.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/summarize_ds_models.html">summarize_ds_models</a></span><span class="op">(</span><span class="va">wren.hn</span>, <span class="va">wren.hr.poly</span>, <span class="va">wren.unif.cos</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">3</span>,</span>
<span>             caption<span class="op">=</span><span class="st">"Model comparison table for wren line transect data, Montrave."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-11">Table 1: </span>Model comparison table for wren line transect data, Montrave.</caption>
<colgroup>
<col width="2%">
<col width="16%">
<col width="37%">
<col width="5%">
<col width="9%">
<col width="8%">
<col width="11%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Model</th>
<th align="left">Key function</th>
<th align="left">Formula</th>
<th align="right">C-vM p-value</th>
<th align="right"><span class="math inline">\(\hat{P_a}\)</span></th>
<th align="right">se(<span class="math inline">\(\hat{P_a}\)</span>)</th>
<th align="right">
<span class="math inline">\(\Delta\)</span>AIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left"></td>
<td align="left">Hazard-rate</td>
<td align="left">~1</td>
<td align="right">0.189</td>
<td align="right">0.844</td>
<td align="right">0.025</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left"></td>
<td align="left">Uniform with cosine adjustment terms of order 1,2,3</td>
<td align="left">NA</td>
<td align="right">0.198</td>
<td align="right">0.757</td>
<td align="right">0.140</td>
<td align="right">4.298</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left"></td>
<td align="left">Half-normal</td>
<td align="left">~1</td>
<td align="right">0.077</td>
<td align="right">0.685</td>
<td align="right">0.057</td>
<td align="right">6.055</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="model-selection-is-not-a-cookbook">Model selection is not a cookbook<a class="anchor" aria-label="anchor" href="#model-selection-is-not-a-cookbook"></a>
</h3>
<p>The AIC model selection tools suggest the hazard rate key function is the preferred model. However, examine the shape of the hazard rate detection function in contrast to the uniform cosine fitted detection function (Figure <a href="#fig:evasive">5</a>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wren.hr.poly</span>, breaks<span class="op">=</span><span class="va">cutpoints</span>, main<span class="op">=</span><span class="st">"Hazard rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wren.unif.cos</span>, breaks<span class="op">=</span><span class="va">cutpoints</span>, main<span class="op">=</span><span class="st">"Uniform cosine"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:evasive"></span>
<img src="lines-distill_files/figure-html/evasive-1.png" alt="Possible evidence of evasive movement of wrens.  Note left figure (hazard rate) with implausible perfect detectability out to 70m, then precipitous decline."><img src="lines-distill_files/figure-html/evasive-2.png" alt="Possible evidence of evasive movement of wrens.  Note left figure (hazard rate) with implausible perfect detectability out to 70m, then precipitous decline."><p class="caption">
Figure 5: Possible evidence of evasive movement of wrens. Note left figure (hazard rate) with implausible perfect detectability out to 70m, then precipitous decline.
</p>
</div>
<p>The fellow who gathered these data (Prof Buckland) maintained the shape of the fitted hazard rate detection function is not plausible. Instead, he chose the uniform key with cosine adjustments for making inference <span class="citation">(Buckland, 2006, p. 352)</span>:</p>
<blockquote>
<p>Common Chaffinch and Winter Wren showed some evidence of observer avoidance. For 2 of the 12 data sets, this resulted in a fitted hazard rate detection function with certain detection out to ∼60 m, with an implausibly rapid fall-off beyond 70 m. In these two analyses, a model with a slightly higher AIC value and a more plausible fit to the detection function was selected.</p>
</blockquote>
<p>This is an example of moderating objective model selection tools with common sense and understanding of field procedures.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Buckland2006" class="csl-entry">
Buckland, S. T. (2006). Point transect surveys for songbirds: Robust methodologies. <em>The Auk</em>, <em>123</em>(2), 345–345. <a href="https://doi.org/10.1642/0004-8038(2006)123%5B345:psfsrm%5D2.0.co;2" class="external-link">https://doi.org/10.1642/0004-8038(2006)123[345:psfsrm]2.0.co;2</a>
</div>
<div id="ref-miller_distance_2019" class="csl-entry">
Miller, D. L., Rexstad, E., Thomas, L., Marshall, L., &amp; Laake, J. L. (2019). Distance sampling in r. <em>Journal of Statistical Software</em>, <em>89</em>(1), 1–28. <a href="https://doi.org/10.18637/jss.v089.i01" class="external-link">https://doi.org/10.18637/jss.v089.i01</a>
</div>
<div id="ref-r_core_team_r_2019" class="csl-entry">
R Core Team. (2019). <em>R: A language and environment for statistical computing</em>. <span>Vienna Austria</span>: R Foundation for Statistical Computing.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance</p>
</div>

    </footer>
</div>

  

  

  
</body>
</html>
