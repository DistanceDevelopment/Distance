<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Abundance estimation for distance sampling models — dht2 • Distance</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Abundance estimation for distance sampling models — dht2"><meta name="description" content="Once a detection function is fitted to data, this function can be used to
compute abundance estimates over required areas. The function also allows
for stratification and variance estimation via various schemes (see below)."><meta property="og:description" content="Once a detection function is fitted to data, this function can be used to
compute abundance estimates over required areas. The function also allows
for stratification and variance estimation via various schemes (see below)."><script type="text/javascript">(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)}; t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;   y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window, document, "clarity", "script", "m9rbql4acz");</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Distance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9009</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lines-distill.html">Line transects</a></li>
    <li><a class="dropdown-item" href="../articles/covariates-distill.html">Covariates in detection</a></li>
    <li><a class="dropdown-item" href="../articles/species-covariate-distill.html">Species as a covariate</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Only for the website</h6></li>
    <li><a class="dropdown-item" href="../articles/web-only/points/pointtransects-distill.html">Point transects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.html">Size bias remedy</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/strata/strata-distill.html">Stratification</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/differences/differences.html">Detecting difference in density between strata</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/variance/variance-distill.html">Variance estimation with bootstrap</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/cues/cuecounts-distill.html">Cue count surveys</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/multipliers/multipliers-distill.html">Indirect surveys</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/multispecies/multispecies-multioccasion-analysis.html">Take care when subsetting multispecies data sets</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/CTDS/camera-distill.html">Camera trap distance sampling</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/alt-optimise/mcds-dot-exe.html">Alternative optimiser</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/predict_detprob/predicting_detection_probabilities.html">Predict detection probabilities</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/Distance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Abundance estimation for distance sampling models</h1>
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/Distance/blob/HEAD/R/dht2.R" class="external-link"><code>R/dht2.R</code></a></small>
      <div class="d-none name"><code>dht2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Once a detection function is fitted to data, this function can be used to
compute abundance estimates over required areas. The function also allows
for stratification and variance estimation via various schemes (see below).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dht2</span><span class="op">(</span></span>
<span>  <span class="va">ddf</span>,</span>
<span>  observations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transects <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geo_strat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flatfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">strat_formula</span>,</span>
<span>  convert_units <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  er_est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R2"</span>, <span class="st">"P2"</span><span class="op">)</span>,</span>
<span>  multipliers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_fraction <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ci_width <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  innes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stratification <span class="op">=</span> <span class="st">"geographical"</span>,</span>
<span>  total_area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  binomial_var <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ddf">ddf<a class="anchor" aria-label="anchor" href="#arg-ddf"></a></dt>
<dd><p>model fitted by <code><a href="ds.html">ds</a></code> or <code><a href="https://rdrr.io/pkg/mrds/man/ddf.html" class="external-link">ddf</a></code>.
Multiple detection functions can be supplied as a <code>list</code>.</p></dd>


<dt id="arg-observations">observations<a class="anchor" aria-label="anchor" href="#arg-observations"></a></dt>
<dd><p><code>data.frame</code> to link detection function data (indexed by
<code>object</code> column IDs) to the transects (indexed by <code>Sample.Label</code> column
IDs). See "Data" below.</p></dd>


<dt id="arg-transects">transects<a class="anchor" aria-label="anchor" href="#arg-transects"></a></dt>
<dd><p><code>data.frame</code> with information about samples (points or
line transects). See "Data" below.</p></dd>


<dt id="arg-geo-strat">geo_strat<a class="anchor" aria-label="anchor" href="#arg-geo-strat"></a></dt>
<dd><p><code>data.frame</code> with information about any geographical
stratification. See "Data" below.</p></dd>


<dt id="arg-flatfile">flatfile<a class="anchor" aria-label="anchor" href="#arg-flatfile"></a></dt>
<dd><p>data in the flatfile format, see <code><a href="flatfile.html">flatfile</a></code>. Note
that the <code>object</code> column (uniquely identifying the observations) is required.</p></dd>


<dt id="arg-strat-formula">strat_formula<a class="anchor" aria-label="anchor" href="#arg-strat-formula"></a></dt>
<dd><p>a formula giving the stratification structure (see
"Stratification" below). Currently only one level of stratification is
supported.</p></dd>


<dt id="arg-convert-units">convert_units<a class="anchor" aria-label="anchor" href="#arg-convert-units"></a></dt>
<dd><p>conversion factor between units for the distances,
effort and area. See "Units" below. Can supply one per detection function in
<code>ddf</code>.</p></dd>


<dt id="arg-er-est">er_est<a class="anchor" aria-label="anchor" href="#arg-er-est"></a></dt>
<dd><p>encounter rate variance estimator to be used. See "Variance"
below and <code><a href="https://rdrr.io/pkg/mrds/man/varn.html" class="external-link">varn</a></code>. Can supply one per detection function in
<code>ddf</code>.</p></dd>


<dt id="arg-multipliers">multipliers<a class="anchor" aria-label="anchor" href="#arg-multipliers"></a></dt>
<dd><p><code>list</code> of <code>data.frame</code>s. See "Multipliers" below.</p></dd>


<dt id="arg-sample-fraction">sample_fraction<a class="anchor" aria-label="anchor" href="#arg-sample-fraction"></a></dt>
<dd><p>proportion of the transect covered (e.g., 0.5 for
one-sided line transects). May be specified as either a single number or a
<code>data.frame</code> with 2 columns <code>Sample.Label</code> and <code>fraction</code> (if fractions are
different for each transect).</p></dd>


<dt id="arg-ci-width">ci_width<a class="anchor" aria-label="anchor" href="#arg-ci-width"></a></dt>
<dd><p>for use with confidence interval calculation (defined as
1-alpha, so the default 95 will give a 95% confidence interval).</p></dd>


<dt id="arg-innes">innes<a class="anchor" aria-label="anchor" href="#arg-innes"></a></dt>
<dd><p>logical flag for computing encounter rate variance using either
the method of Innes et al. (2002)
 where estimated abundance per transect
divided by effort is used as the encounter rate, vs. (when <code>innes=FALSE</code>)
using the number of observations divided by the effort (as in Buckland et al. 2001
)</p></dd>


<dt id="arg-stratification">stratification<a class="anchor" aria-label="anchor" href="#arg-stratification"></a></dt>
<dd><p>what do strata represent, see "Stratification" below.</p></dd>


<dt id="arg-total-area">total_area<a class="anchor" aria-label="anchor" href="#arg-total-area"></a></dt>
<dd><p>for options <code>stratification="effort_sum"</code> and
<code>stratification="replicate"</code> the area to use as the total for combined,
weighted final estimates.</p></dd>


<dt id="arg-binomial-var">binomial_var<a class="anchor" aria-label="anchor" href="#arg-binomial-var"></a></dt>
<dd><p>if we wish to estimate abundance for the covered area
only (i.e., study area = surveyed area) then this must be set to be
<code>TRUE</code> and use the negative binomial variance estimator of
Borchers et al. (1998)
. This is only valid when
objects are not clustered. (This situation
is rare.)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a <code>data.frame</code> (of class <code>dht_result</code> for pretty printing) with
estimates and attributes containing additional information, see "Outputs"
for information on column names.</p>
    </div>
    <div class="section level2">
    <h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a></h2>


<p>The data format allows for complex stratification schemes to be set-up. Three
objects are always required:</p><ul><li><p><code>ddf</code> the detection function (see <code><a href="ds.html">ds</a></code> or
<code><a href="https://rdrr.io/pkg/mrds/man/ddf.html" class="external-link">ddf</a></code> for information on the format of their inputs).</p></li>
<li><p><code>observations</code> has one row per observation and links the observations to
the transects. Required columns:</p><ul><li><p><code>object</code> (unique ID for the observation, which must match with the
data in the detection function)</p></li>
<li><p><code>Sample.Label</code> (unique ID for the transect).</p></li>
<li><p>Additional columns for strata which are not included in the detection
function are required (stratification covariates that are included in
the detection function do not need to be included here). The important
case here is group size, which must have column name <code>size</code> (but does
not need to be in the detection function).</p></li>
</ul></li>
<li><p><code>transects</code> has one row per sample (point or line transect). At least
one row is required. Required columns: <code>Sample.Label</code> (unique ID for the
transect), <code>Effort</code> (line length for line transects, number of visits for
point transects), if there is more than one geographical stratum.</p></li>
</ul><p>With only these three arguments, abundance can only be calculated for the
covered area. Including additional information on the area we wish to
extrapolate to (i.e., the study area), we can obtain abundance estimates:</p><ul><li><p><code>geo_strat</code> has one row for each stratum that we wish to estimate
abundance for. For abundance in the study area, at least one row is
required. Required columns: <code>Area</code> (the area of that stratum). If there
is &gt;1 row, then additional columns, named in <code>strat_formula</code>.`</p></li>
</ul><p>Note that if the <code>Area</code> column is set to all 0, then only density estimates
will be returned.</p>
    </div>
    <div class="section level2">
    <h2 id="multipliers">Multipliers<a class="anchor" aria-label="anchor" href="#multipliers"></a></h2>


<p>It is often the case that we cannot measure distances to individuals or
groups directly, but instead need to estimate distances to something they
produce (e.g., for whales, their blows; for elephants their dung) – this is
referred to as indirect sampling. We may need to use estimates of production
rate and decay rate for these estimates (in the case of dung or nests) or
just production rates (in the case of songbird calls or whale blows). We
refer to these conversions between "number of cues" and "number of animals"
as "multipliers".</p>
<p>The <code>multipliers</code> argument is a <code>list</code>, with 2 possible elements (<code>creation</code>
and <code>decay</code>). Each element of which is a <code>data.frame</code> and must have at least
a column named <code>rate</code>, which abundance estimates will be divided by (the
term "multiplier" is a misnomer, but kept for compatibility with Distance
for Windows). Additional columns can be added to give the standard error and
degrees of freedom for the rate if known as <code>SE</code> and <code>df</code>, respectively. You
can use a multirow <code>data.frame</code> to have different rates for different
geographical areas (for example). In this case the rows need to have a
column (or columns) to <code>merge</code> with the data (for example <code>Region.Label</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="stratification">Stratification<a class="anchor" aria-label="anchor" href="#stratification"></a></h2>


<p>The <code>strat_formula</code> argument is used to specify a column to use to stratify
the results, using the form <code>~column.name</code> where <code>column.name</code> is the column
name you wish to use.</p>
<p>The <code>stratification</code> argument is used to specify which of four types of
stratification are intended:</p><ul><li><p><code>"geographical"</code> if each stratum represents a different geographical
areas and you want the total over all the areas</p></li>
<li><p><code>"effort_sum"</code> if your strata are in fact from replicate
surveys (perhaps using different designs) but you don't have many
replicates and/or want an estimate of "average variance"</p></li>
<li><p><code>"replicate"</code> if you have replicate surveys but have many of them, this
calculates the average abundance and the variance between those many
surveys (think of a population of surveys)</p></li>
<li><p><code>"object"</code> if the stratification is really about the type of object
observed, for example sex, species or life stage and what you want is the
total number of individuals across all the classes of objects. For example,
if you have stratified by sex and have males and females, but also want a
total number of animals, you should use this option.</p></li>
</ul><p>A simple example of using <code>stratification="geographical"</code> is given below.
Further examples can be found at <a href="https://distancesampling.org/resources/vignettes.html" class="external-link">https://distancesampling.org/resources/vignettes.html</a>
(see, e.g., the deer pellet survey).</p>
    </div>
    <div class="section level2">
    <h2 id="variance">Variance<a class="anchor" aria-label="anchor" href="#variance"></a></h2>


<p>Variance in the estimated abundance comes from multiple sources. Depending
on the data used to fit the model and estimate abundance, different
components will be included in the estimated variances. In the simplest
case, the detection function and encounter rate variance need to be
combined. If group size varies, then this too must be included. Finally, if
multipliers are used and have corresponding standard errors given, this are
also included. Variances are combined by assuming independence between the
measures and adding variances. A brief summary of how each component is
calculated is given here, though see references for more details.</p><ul><li><p><em>detection function</em>: variance from the detection function parameters is
transformed to variance about the abundance via a sandwich estimator (see
e.g., Appendix C of Borchers et al. (2002)
).</p></li>
<li><p><em>encounter rate</em>: for strata with &gt;1 transect in them, the encounter
rate estimators given in Fewster et al. (2009)
 can be specified via the
<code>er_est</code> argument. If the argument <code>innes=TRUE</code> then calculations use the
estimated number of individuals in the transect (rather than the
observed), which was given by Innes et al. (2002)
 as a superior estimator.
When there is only one transect in a stratum, Poisson variance is assumed.
Information on the Fewster encounter rate variance estimators are given in
<code><a href="https://rdrr.io/pkg/mrds/man/varn.html" class="external-link">varn</a></code></p></li>
<li><p><em>group size</em>: if objects occur in groups (sometimes "clusters"), then
the empirical variance of the group sizes is added to the total variance.</p></li>
<li><p><em>multipliers</em>: if multipliers with standard errors are given, their
corresponding variances are added. If no standard errors are supplied,
then their contribution to variance is assumed to be 0.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="units">Units<a class="anchor" aria-label="anchor" href="#units"></a></h2>


<p>It is often the case that distances are recorded in one convenient set of
units, whereas the study area and effort are recorded in some other units.
To ensure that the results from this function are in the expected units, we
use the <code>convert_units</code> argument to supply a single number to convert the
units of the covered area to those of the study/stratification area (results
are always returned in the units of the study area). For line transects, the
covered area is calculated as <code>2 * width * length</code> where <code>width</code> is the
effective (half)width of the transect (often referred to as w in the
literature) and <code>length</code> is the line length (referred to as L). If <code>width</code>
and <code>length</code> are measured in kilometres and the study area in square
kilometres, then all is fine and <code>convert_units</code> is 1 (and can be ignored).
If, for example, line length and distances were measured in metres, we
instead need to convert this to be kilometres, by dividing by 1000 for each
of distance and length, hence <code>convert_units=1e-6</code>. For point transects,
this is slightly easier as we only have the radius and study area to
consider, so the conversion is just such that the units of the truncation
radius are the square root of the study area units.</p>
    </div>
    <div class="section level2">
    <h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a></h2>


<p>On printing the output from call to <code>dht2</code>, three tables are produced. Below is a guide to the output columns names, per table.</p><ul><li><p>Summary statistics table</p><ul><li><p><code>Region.Label</code> Stratum name (this first column name depends on the <code>formula</code> supplied)</p></li>
<li><p><code>Area</code> Size of stratum</p></li>
<li><p><code>CoveredArea</code> Surveyed area in stratum (2 x w x L)</p></li>
<li><p><code>Effort</code> Transect length or number of point visits per stratum</p></li>
<li><p><code>n</code> Number of detections</p></li>
<li><p><code>k</code> Number of replicate transects</p></li>
<li><p><code>ER</code> Encounter rate</p></li>
<li><p><code>se.ER</code> Standard error of encounter rate</p></li>
<li><p><code>cv.ER</code> Coefficient of variation of encounter rate</p></li>
</ul></li>
<li><p>Abundance or density estimates table:</p><ul><li><p><code>Region.Label</code> As above</p></li>
<li><p><code>Estimate</code> Point estimate of abundance or density</p></li>
<li><p><code>se</code> Standard error</p></li>
<li><p><code>cv</code> Coefficient of variation</p></li>
<li><p><code>LCI</code> Lower confidence bound</p></li>
<li><p><code>UCI</code> Upper confidence bound</p></li>
<li><p><code>df</code> Degrees of freedom used for confidence interval computation</p></li>
</ul></li>
<li><p>Components percentage of variance:</p><ul><li><p><code>Region.Label</code> As above</p></li>
<li><p><code>Detection</code> Percent of variance in abundance/density associated with
detection function uncertainty</p></li>
<li><p><code>ER</code> Percent of variance in abundance/density associated with
variability in encounter rate</p></li>
<li><p><code>Multipliers</code> Percent of variance in abundance/density associated with
uncertainty in multipliers</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Borchers DL, Buckland ST, Goedhart PW, Clarke ED, Hedley SL (1998).
“Horvitz-Thompson Estimators for Double-Platform Line Transect Surveys.”
<em>Biometrics</em>, <b>54</b>(4), 1221-1237.
<a href="https://doi.org/10.2307/253365" class="external-link">doi:10.2307/253365</a>
.<br><br> Borchers DL, Buckland ST, Zucchini W (2002).
<em>Estimating animal abundance: closed populations</em>.
Springer.<br><br> Buckland ST, Anderson DR, Burnham KP, Laake JL, Borchers DL, Thomas L (2001).
<em>Introduction to distance sampling: estimating abundance of biological populations</em>.
Oxford university press.<br><br> Fewster RM, Buckland ST, Burnham KP, Borchers DL, Jupp PE, Laake JL, Thomas L (2009).
“Estimating the encounter rate variance in distance sampling.”
<em>Biometrics</em>, <b>65</b>(1), 225-236.<br><br> Innes S, Heide-Jørgensen MP, Laake JL, Laidre KL, Cleator HJ, Richard P, Stewart RE (2002).
“Surveys of belugas and narwhals in the Canadian High Arctic in 1996.”
<em>NAMMCO Scientific Publications</em>, <b>4</b>, 169-190.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># example of simple geographical stratification</span></span></span>
<span class="r-in"><span><span class="co"># minke whale data, with 2 strata: North and South</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">minke</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># first fitting the detection function</span></span></span>
<span class="r-in"><span><span class="va">minke_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="ds.html">ds</a></span><span class="op">(</span><span class="va">minke</span>, truncation<span class="op">=</span><span class="fl">1.5</span>, adjustment<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># now estimate abundance using dht2</span></span></span>
<span class="r-in"><span><span class="co"># stratum labels are in the Region.Label column</span></span></span>
<span class="r-in"><span><span class="va">minke_dht2</span> <span class="op">&lt;-</span> <span class="fu">dht2</span><span class="op">(</span><span class="va">minke_df</span>, flatfile<span class="op">=</span><span class="va">minke</span>, stratification<span class="op">=</span><span class="st">"geographical"</span>,</span></span>
<span class="r-in"><span>                   strat_formula<span class="op">=</span><span class="op">~</span><span class="va">Region.Label</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># could compare this to minke_df$dht and see the same results</span></span></span>
<span class="r-in"><span><span class="va">minke_dht2</span></span></span>
<span class="r-in"><span><span class="co"># can alternatively report density</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">minke_dht2</span>, report<span class="op">=</span><span class="st">"density"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer></div>





  </body></html>

