<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>The flatfile data format — flatfile • Distance</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The flatfile data format — flatfile"><meta name="description" content='Distance allows loading data as a "flat file" and analyse data (and
obtain abundance estimates) straight away, provided that the format of the
flat file is correct. One can provide the file as, for example, an Excel
spreadsheet using readxl::read_xls in or CSV using
read.csv.'><meta property="og:description" content='Distance allows loading data as a "flat file" and analyse data (and
obtain abundance estimates) straight away, provided that the format of the
flat file is correct. One can provide the file as, for example, an Excel
spreadsheet using readxl::read_xls in or CSV using
read.csv.'></head><body><p>








  list(file = "Clarity.txt")

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Distance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lines-distill.html">Line transects</a></li>
    <li><a class="dropdown-item" href="../articles/covariates-distill.html">Covariates in detection</a></li>
    <li><a class="dropdown-item" href="../articles/species-covariate-distill.html">Species as a covariate</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Only for the website</h6></li>
    <li><a class="dropdown-item" href="../articles/web-only/points/pointtransects-distill.html">Point transects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/groupsize/Remedy-size-bias-for-dolphin-surveys.html">Size bias remedy</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/strata/strata-distill.html">Stratification</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/differences/differences.html">Detecting difference in density between strata</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/variance/variance-distill.html">Variance estimation with bootstrap</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/cues/cuecounts-distill.html">Cue count surveys</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/multipliers/multipliers-distill.html">Indirect surveys</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/multispecies/multispecies-multioccasion-analysis.html">Take care when subsetting multispecies data sets</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/CTDS/camera-distill.html">Camera trap distance sampling</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/alt-optimise/mcds-dot-exe.html">Alternative optimiser</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DistanceDevelopment/Distance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The flatfile data format</h1>
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/Distance/blob/HEAD/R/Distance-package.R" class="external-link"><code>R/Distance-package.R</code></a></small>
      <div class="d-none name"><code>flatfile.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>Distance</code> allows loading data as a "flat file" and analyse data (and
obtain abundance estimates) straight away, provided that the format of the
flat file is correct. One can provide the file as, for example, an Excel
spreadsheet using <code><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_xls</a></code> in or CSV using
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></code>.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Each row of the data table corresponds to either: (1) an observation or (2)
a sample (transect) without observations. In either case the following
columns must be present:</p><ul><li><p><code>distance</code> observed distance to object</p></li>
<li><p><code>object</code> a unique identifier for each observation (only required when
using <code><a href="dht2.html">dht2</a></code>)</p></li>
<li><p><code>Sample.Label</code> identifier for the sample (transect id)</p></li>
<li><p><code>Effort</code> effort for this transect (e.g. line transect length or number
of times point transect was visited)</p></li>
<li><p><code>Region.Label</code> label for a given stratum (see below)</p></li>
<li><p><code>Area</code> area of the strata<code>When the row represents a transect without observations,</code>distance<code>and any other observation-specific covariates (including</code>size<code>and detection function covariates) take the value</code>NA`.</p></li>
</ul><p>Note that in the simplest case (one area surveyed only once) there is only
one <code>Region.Label</code> and a single corresponding <code>Area</code> duplicated for each
observation.</p>
<p>The example given below was provided by Eric Rexstad. Additional examples
can be found at  <a href="http://examples.distancesampling.org/" class="external-link">http://examples.distancesampling.org/</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/Distance/" class="external-link">Distance</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Need to have the readxl package installed from CRAN</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Need to get the file path first</span></span></span>
<span class="r-in"><span><span class="va">minke.filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"minke.xlsx"</span>, package<span class="op">=</span><span class="st">"Distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load the Excel file, note that col_names=FALSE and we add column names after</span></span></span>
<span class="r-in"><span><span class="va">minke</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_xlsx</a></span><span class="op">(</span><span class="va">minke.filepath</span>, col_names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">minke</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Region.Label"</span>, <span class="st">"Area"</span>, <span class="st">"Sample.Label"</span>, <span class="st">"Effort"</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># One may want to call edit(minke) or head(minke) at this point</span></span></span>
<span class="r-in"><span><span class="co"># to examine the data format</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## perform an analysis using the exact distances</span></span></span>
<span class="r-in"><span><span class="va">pooled.exact</span> <span class="op">&lt;-</span> <span class="fu"><a href="ds.html">ds</a></span><span class="op">(</span><span class="va">minke</span>, truncation<span class="op">=</span><span class="fl">1.5</span>, key<span class="op">=</span><span class="st">"hr"</span>, order<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pooled.exact</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Try a binned analysis</span></span></span>
<span class="r-in"><span><span class="co"># first define the bins</span></span></span>
<span class="r-in"><span><span class="va">dist.bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.214</span>, <span class="fl">.428</span>,<span class="fl">.643</span>,<span class="fl">.857</span>,<span class="fl">1.071</span>,<span class="fl">1.286</span>,<span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pooled.binned</span> <span class="op">&lt;-</span> <span class="fu"><a href="ds.html">ds</a></span><span class="op">(</span><span class="va">minke</span>, truncation<span class="op">=</span><span class="fl">1.5</span>, cutpoints<span class="op">=</span><span class="va">dist.bins</span>, key<span class="op">=</span><span class="st">"hr"</span>,</span></span>
<span class="r-in"><span>                    order<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># binned with stratum as a covariate</span></span></span>
<span class="r-in"><span><span class="va">minke</span><span class="op">$</span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">minke</span><span class="op">$</span><span class="va">Region.Label</span><span class="op">==</span><span class="st">"North"</span>, <span class="st">"N"</span>, <span class="st">"S"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">strat.covar.binned</span> <span class="op">&lt;-</span> <span class="fu"><a href="ds.html">ds</a></span><span class="op">(</span><span class="va">minke</span>, truncation<span class="op">=</span><span class="fl">1.5</span>, key<span class="op">=</span><span class="st">"hr"</span>,</span></span>
<span class="r-in"><span>                         formula<span class="op">=</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">stratum</span><span class="op">)</span>, cutpoints<span class="op">=</span><span class="va">dist.bins</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratified by North/South</span></span></span>
<span class="r-in"><span><span class="va">full.strat.binned.North</span> <span class="op">&lt;-</span> <span class="fu"><a href="ds.html">ds</a></span><span class="op">(</span><span class="va">minke</span><span class="op">[</span><span class="va">minke</span><span class="op">$</span><span class="va">Region.Label</span><span class="op">==</span><span class="st">"North"</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>                  truncation<span class="op">=</span><span class="fl">1.5</span>, key<span class="op">=</span><span class="st">"hr"</span>, order<span class="op">=</span><span class="fl">0</span>, cutpoints<span class="op">=</span><span class="va">dist.bins</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">full.strat.binned.South</span> <span class="op">&lt;-</span> <span class="fu"><a href="ds.html">ds</a></span><span class="op">(</span><span class="va">minke</span><span class="op">[</span><span class="va">minke</span><span class="op">$</span><span class="va">Region.Label</span><span class="op">==</span><span class="st">"South"</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>                     truncation<span class="op">=</span><span class="fl">1.5</span>, key<span class="op">=</span><span class="st">"hr"</span>, order<span class="op">=</span><span class="fl">0</span>, cutpoints<span class="op">=</span><span class="va">dist.bins</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## model summaries</span></span></span>
<span class="r-in"><span><span class="va">model.sel.bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pooled f(0)"</span>, <span class="st">"Stratum covariate"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"Full stratification"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            aic<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pooled.binned</span><span class="op">$</span><span class="va">ddf</span><span class="op">$</span><span class="va">criterion</span>,</span></span>
<span class="r-in"><span>                                  <span class="va">strat.covar.binned</span><span class="op">$</span><span class="va">ddf</span><span class="op">$</span><span class="va">criterion</span>,</span></span>
<span class="r-in"><span>                                  <span class="va">full.strat.binned.North</span><span class="op">$</span><span class="va">ddf</span><span class="op">$</span><span class="va">criterion</span><span class="op">+</span></span></span>
<span class="r-in"><span>                                  <span class="va">full.strat.binned.South</span><span class="op">$</span><span class="va">ddf</span><span class="op">$</span><span class="va">criterion</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note model with stratum as covariate is most parsimonious</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model.sel.bin</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance, please <a href="mailto:distance@st-andrews.ac.uk">email us</a>.</p>
</div>

    </footer></div>





  
</body></html>

